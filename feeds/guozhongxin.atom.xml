<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>guozhongxin's blog</title><link href="http://www.guozhongxin.com/" rel="alternate"></link><link href="http://www.guozhongxin.com/feeds/guozhongxin.atom.xml" rel="self"></link><id>http://www.guozhongxin.com/</id><updated>2017-05-02T23:00:00+08:00</updated><entry><title>è¿Ÿåˆ°çš„æ¯•ä¸šæ±‚èŒæ€»ç»“ï¼šå…œå…œè½¬è½¬å›åˆ°èµ·ç‚¹</title><link href="http://www.guozhongxin.com/pages/2017/05/02/jobhunting.html" rel="alternate"></link><updated>2017-05-02T23:00:00+08:00</updated><author><name>guozhongxin</name></author><id>tag:www.guozhongxin.com,2017-05-02:pages/2017/05/02/jobhunting.html</id><summary type="html">&lt;h2&gt;èµ·æ­¥æœ‰ç‚¹æ…¢çš„æ±‚èŒå­£&lt;/h2&gt;
&lt;p&gt;ä¹‹å‰æ‰¾å®ä¹ æœºä¼šè¿˜æ˜¯æŒºé¡ºåˆ©çš„ï¼Œå¯¼è‡´æˆ‘åˆ°äº†7æœˆä»½äº†éƒ½æ²¡æ€ä¹ˆå‡†å¤‡é¢è¯•å¥—è·¯ï¼Œä¹Ÿæ²¡æ€ä¹ˆåˆ·é¢˜ã€‚æ…¢çƒ­çš„æˆ‘ç›´æ¥é”™è¿‡äº†å¾ˆå¤šäº’è”ç½‘å…¬å¸çš„å†…æ¨ã€‚åœ¨æ­¤è¦ç‰¹åœ°å‹æƒ…æç¤ºä¸€ä¸‹è¦æ‰¾å·¥ä½œçš„åº”å±Šç”Ÿï¼Œ&lt;strong&gt;ä¸€å®šè¦èµ¶æ—©æŠ•ç®€å†&lt;/strong&gt;ï¼Œç‰¹åˆ«æ˜¯å†…æ¨ç¯èŠ‚ï¼Œä¸è¦æ‹–åˆ°æ”¶ç®€å†çš„æœ€åå‡ å¤©ï¼Œå› ä¸ºå¾ˆå¤§æ¦‚ç‡ä¸Šhrä»¬å·²ç»è¢«ç®€å†æ·¹æ²¡ï¼Œåè¾¹æŠ•çš„å°±ä¸ç†äº†ã€‚&lt;/p&gt;
&lt;h2&gt;æˆ‘çš„æ±‚èŒæ–¹å‘&lt;/h2&gt;
&lt;p&gt;æˆ‘æ±‚èŒçš„ä¸»è¦ä¸¤ä¸ªæ–¹å‘ï¼šä¸€æ˜¯åˆ†å¸ƒå¼è®¡ç®—å·¥ç¨‹å¸ˆï¼ŒäºŒæ˜¯ç®—æ³•å·¥ç¨‹å¸ˆã€‚ä¸ªäººæ›´å€¾å‘äºå‰è€…ï¼Œä½†æ˜¯è¿˜æ˜¯è¦çœ‹å…·ä½“å·¥ä½œå†…å®¹ã€‚è€Œä¸”æœ‰äº›å…¬å¸é¢è¯•æ—¶å²—ä½åˆ†çš„ä¸æ˜¯é‚£ä¹ˆç»†ã€‚&lt;/p&gt;
&lt;h2&gt;æ±‚èŒå‰çš„å‡†å¤‡&lt;/h2&gt;
&lt;h3&gt;1.é¦–å…ˆè¿˜æ˜¯è¦å¥½å¥½åˆ·é¢˜çš„&lt;/h3&gt;
&lt;p&gt;ä¸€æ–¹é¢è¦æŠŠç®—æ³•é¢˜åˆ·èµ·æ¥ï¼Œå…¶å®æˆ‘å»ºè®®è¶Šæ—©è¶Šå¥½ï¼Œæˆ‘æ­£å¼åˆ·é¢˜èµ·æ­¥å¤ªæ™šï¼Œå¥½åœ¨ä¹‹å‰æœ‰ç‚¹åŸºç¡€ã€‚åœ¨æ”¹å®Œè®ºæ–‡çš„ä¸€ä¸ªæœˆçš„æ—¶é—´é‡Œï¼Œå…ˆåˆ·å®Œäº†ã€Šå‰‘æŒ‡offerã€‹ï¼Œã€Šç¼–ç¨‹ä¹‹ç¾ã€‹ï¼Œä»¥åŠéƒ¨åˆ†Leetcodeä¸­ç­‰ä»¥ä¸Šçš„é¢˜ç›®ï¼Œä¸å¾—ä¸è¯´ï¼Œåˆ·é¢˜è¿˜æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ï¼Œèµ·ç é€‚ç”¨äºé¢è¯•ã€‚&lt;/p&gt;
&lt;p&gt;å¦ä¸€æ–¹é¢æ˜¯åŸºç¡€çŸ¥è¯†ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼šæ“ä½œç³»ç»Ÿï¼Œè®¡ç®—æœºç½‘ç»œï¼Œç¼–ç¨‹è¯­è¨€ï¼Œè®¾è®¡æ¨¡å¼ï¼Œç¼–ç¨‹æ¡†æ¶ï¼Œlinuxç­‰ç­‰ã€‚æˆ‘çš„å·¥ç¨‹çŸ¥è¯†æ˜¯å¼±ç‚¹ï¼Œå°½ç®¡æå‰çœ‹äº†äº›JVMå’Œjavaç¼–ç¨‹æ¡†æ¶ç­‰ç­‰æ–¹é¢çš„çŸ¥è¯†ï¼Œä½†æ˜¯é‡åˆ°åœ¨è¿™æ–¹é¢æ·±ç©¶çš„é¢è¯•å®˜ï¼Œè¿˜æ˜¯ä¼šæ‰è¥Ÿè§è‚˜ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åæ˜¯å’Œè‡ªå·±æ±‚èŒå²—ä½ç›´æ¥ç›¸å…³çš„å†…å®¹ã€‚å¯¹äºæˆ‘è€Œè¨€ï¼ŒåŒ…æ‹¬æœºå™¨å­¦ä¹ ç®—æ³•åŸç†ã€å…¬å¼æ¨å¯¼ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿç­‰ç­‰ã€‚å¯¹äºè‡ªå·±æ“…é•¿çš„åˆ†å¸ƒå¼ç³»ç»Ÿæ–¹é¢ï¼Œæˆ‘é‡æ–°ç¿»äº†ä¸€éç¤¾åŒºå’Œæºç ï¼Œå¹¶ä¸”å¯¹ä¸€äº›ä¸»æµæŠ€æœ¯çš„ä¼˜åŠ£éƒ½å¿ƒä¸­æœ‰æ•°ã€‚&lt;/p&gt;
&lt;h3&gt;2.å‡†å¤‡ä¸€ä»½å¥½çœ‹çš„ç®€å†&lt;/h3&gt;
&lt;p&gt;æ‰€è°“å¥½çœ‹ï¼Œå„å®¶æ ‡å‡†ä¸ä¸€ã€‚æ€»å½’è¦ï¼šæ ¼å¼æ¸…æ™°ï¼Œå†…å®¹è¯¦å®æœ€å¥½æœ‰æ•°æ®ï¼Œæœ€å¥½ä¸€é¡µï¼Œçªå‡ºé‡ç‚¹ã€‚å·¥ç¨‹å¸ˆçš„ç®€å†è¿˜æ˜¯è¦çªå‡ºè‡ªå·±çš„é¡¹ç›®å’Œå®ä¹ ç»å†çš„ï¼Œä¸€äº›ç›¸å…³çš„å¥–é¡¹ä¹Ÿä¼šå¢æ·»å…‰å½©ï¼Œå¤ªè¿‡æ™®éçš„æˆç»©æˆ–è€…å’Œæ±‚èŒä¸ç›¸å…³çš„ç»å†å°±æ²¡å¿…è¦å†™äº†ã€‚æ¯”å¦‚è¦åšç¨‹åºå‘˜å°±æ²¡å¿…è¦å†™å­¦ç”Ÿå¹²éƒ¨ç»å†äº†ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘åœ¨å®ä¹ ä¹‹å‰å°±æœ‰ç›¸å¯¹å®Œå–„çš„ä¸­è‹±æ–‡ç®€å†ï¼Œåæ¥mentoråˆç»™äº†ä¸€äº›å»ºè®®ï¼Œæˆ‘ä¹Ÿä¼šç»å¸¸updateã€‚åœ¨å‡†å¤‡ç®€å†çš„æ—¶å€™ï¼Œé¡ºä¾¿åå¤ç»ƒä¹ æ€ä¹ˆæŠŠè‡ªå·±çš„é¡¹ç›®ç»å†å‡†ç¡®ç®€æ´çš„æè¿°å‡ºæ¥ï¼Œè¿™ä¸€ç‚¹è¿˜æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚åœ¨é¢è¯•ä¸­è¿è‡ªå·±çš„é¡¹ç›®ç»å†éƒ½è¡¨è¿°çš„æ¨¡æ£±ä¸¤å¯ç£•ç£•ç»Šç»Šï¼Œè¿™å¯æ˜¯æå¤§çš„å‡åˆ†é¡¹ã€‚&lt;/p&gt;
&lt;h3&gt;3.å’Œæ±‚èŒå°ä¼™ä¼´åŠæ—¶åˆ†äº«ä¿¡æ¯&lt;/h3&gt;
&lt;p&gt;è¿™ä¸€ç‚¹å¸®æˆ‘æ¯”è¾ƒå¿«çš„è¿›å…¥æ±‚èŒèŠ‚å¥ï¼Œä¸æ–­å‘ç°è‡ªå·±æ¬ ç¼ºçš„åœ°æ–¹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¦ä¿æŒå¿ƒæ€çš„ç¨³å®šï¼Œå¯¹è‡ªå·±çš„å®šä½è¦ä¿æŒæ¸…é†’ï¼Œä¸è¦è¢«å¹²æ‰°ã€‚&lt;/p&gt;
&lt;h3&gt;4.å®æˆ˜é”»ç‚¼&lt;/h3&gt;
&lt;p&gt;å…¶å®æœ€å¥½çš„æé«˜æ–¹æ³•è¿˜æ˜¯å®æˆ˜ï¼Œå¤šé¢å‡ æ¬¡è‡ªç„¶å°±æ‡‚é¢è¯•å¥—è·¯äº†ã€‚&lt;/p&gt;
&lt;h2&gt;ä¸€æ­¥ä¸€æ­¥æ±‚èŒè·¯&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ç™¾åº¦Â·å‡¤å·¢ï¼šè¿™æ˜¯æœ€æ—©æŠ•çš„ï¼Œä¸­åˆåˆ°ä¸‹åˆï¼Œä¸‰é¢ä¸€å£æ°”é¢å®Œã€‚æˆ‘æŠ•çš„æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿæ–¹å‘ï¼Œé¢è¯•çš„ç»„æ˜¯åšç­–ç•¥ç®—æ³•çš„ã€‚æœ‰ä¸¤ä¸ªå…³äºåˆ†å¸ƒå¼ç®—æ³•çš„é—®é¢˜ï¼Œæ¯”è¾ƒåå®é™…åº”ç”¨åœºæ™¯ã€‚æœ‰3é“ä»£ç é¢˜ï¼Œmediuméš¾åº¦ä¸Šä¸‹ã€‚äº‹åå¹³å°ç»„åˆé—®æˆ‘è¦ä¸è¦é¢ä»–ä»¬ç»„ï¼Œä½†ç›¸å½“äºæ”¾å¼ƒäº†ä¹‹å‰é¢çš„ç­–ç•¥ç»„ï¼Œå› ä¸ºè€ƒè™‘åˆ°è¿™æ˜¯ç¬¬ä¸€ä¸ªofferï¼Œå°±æƒ³ç€æ±‚ç¨³ï¼Œæ²¡æœ‰å†é¢ã€‚ç™¾åº¦æœ€å¼€å§‹offerç»™çš„æ‰¹å‘ä»·ï¼Œè¦æ‹¿å…¶ä»–å…¬å¸çš„offerå»argueï¼Œéå¸¸æ²¡æœ‰è¯šæ„ã€‚å°½ç®¡åæ¥è°ˆåˆ°specialï¼Œè€Œä¸”è¡¨ç¤ºå¯ä»¥å†ç”³è¯·æ›´é«˜ï¼Œè¿˜æ˜¯æ‹’æ‰äº†ç™¾åº¦ã€‚&lt;/li&gt;
&lt;li&gt;äº¬ä¸œÂ·å¹¿å‘Šï¼šç¬¬ä¸€æ¬¡é¢äº†ç®—æ³•ç»„ï¼Œç¬¬ä¸€é¢å¡åœ¨äº†è®¾è®¡æ¨¡å¼ä¸Šã€‚ã€‚è¢«æ‹’ã€‚ã€‚ç¬¬äºŒæ¬¡é¢äº†å¹³å°ç»„ï¼Œå°±æ¯”è¾ƒå¾—å¿ƒåº”æ‰‹äº†ã€‚å’Œä¸‰é¢é¢è¯•å®˜èŠå¾—ä¸é”™ï¼Œè€Œä¸”åæ¥ç»™çš„offerå½“æ—¶çœ‹æ¥æ¯”ç™¾åº¦çš„é«˜ï¼Œå°±æ„‰å¿«çš„æ¥å—äº†ã€‚åæ¥è¿˜æ˜¯å‘ç°è‡ªå·±å¤ªnaiveäº†ï¼Œæœ€åä¸å¾—ä¸æ¯æ‰ã€‚ã€‚å‘äº¬ä¸œå¹¿å‘Šç»„é“æ­‰ã€‚ã€‚&lt;/li&gt;
&lt;li&gt;èš‚èšé‡‘æœÂ·äººå·¥æ™ºèƒ½ï¼šå››è½®é¢è¯•ï¼Œä¸»è¦æ˜¯åç®—æ³•æ–¹å‘çš„ï¼Œéš¾åº¦è¿˜æ˜¯å¾ˆå¤§çš„ï¼Œéƒ½æ˜¯åœ¨çº¿é¢çš„ï¼Œä¹‹åHRé¢è¯´åŒ—äº¬åé¢æ¯”è¾ƒå°‘ï¼Œé—®æˆ‘å»ä¸å»æ­å·ï¼Œæˆ‘è¯´ä¸å»ã€‚ä¹‹ååˆåŠ äº†ç¬¬5è½®ï¼Œè™½ç„¶ç¬¬äº”è½®é¢çš„ä¹Ÿè¿˜è¡Œï¼Œä½†æœ€ç»ˆè¿˜æ˜¯è¢«æ‹’ã€‚&lt;/li&gt;
&lt;li&gt;360ï¼šä¸€é¢è¢«æŒ‚ï¼Œé¢è¯•æ—¶è„‘å­é”ˆä½äº†ã€‚ã€‚&lt;/li&gt;
&lt;li&gt;æ»´æ»´ï¼šé¢è¯•ç°åœºæå…¶æ··ä¹±ï¼Œæ‰€æœ‰åŒå­¦åº”è¯¥éƒ½æ„ŸåŒèº«å—ã€‚æˆ‘ä»ä¸Šåˆ8ç‚¹åŠåˆ°ï¼Œä¸€ç›´åˆ°ä¸‹åˆ2ç‚¹æ‰æ‰¾åˆ°ä¸€é¢é¢è¯•å®˜ï¼Œ3é¢+HRé¢ç»“æŸåï¼Œå·²ç»æ™šä¸Š8ç‚¹å¤šäº†ï¼æŠ•çš„å¤§æ•°æ®å¼€å‘å·¥ç¨‹å¸ˆï¼Œä½†æ˜¯å¯¹å£çš„é¢è¯•å®˜éƒ½ä¸åœ¨ï¼Œæˆ‘ä¹Ÿæ˜¯æœäº†ï¼Œå¯¹æ»´æ»´æ²¡å•¥å¥½å°è±¡ã€‚&lt;/li&gt;
&lt;li&gt;ä¸€ç‚¹èµ„è®¯ï¼šæ˜¯å­¦é•¿å†…æ¨çš„ï¼Œé¢è¯•çš„ç»„æ˜¯åšçˆ¬è™«çš„ã€‚ã€‚é¢è¯•ä¸­ä¸»è¦åœ¨javaçŸ¥è¯†ä¸Šæ ½äº†è·Ÿå¤´ï¼Œä¸‰é¢è¢«æ‹’äº†ã€‚&lt;/li&gt;
&lt;li&gt;ç½‘æ˜“æœ‰é“ï¼šæ²¡æœ‰å…·ä½“åŒºåˆ†å²—ä½ï¼Œä½†æ˜¯äºŒä¸‰é¢é¢è¯•å®˜éƒ½æ˜¯åšå¹¿å‘Šçš„ï¼ŒçŸ¥é“æˆ‘æ˜¯åšåˆ†å¸ƒå¼çš„ï¼Œé—®äº†å¾ˆå¤šå¹¿å‘Šç³»ç»Ÿçš„é—®é¢˜ï¼Œå›ç­”çš„è¿˜å¯ä»¥ã€‚ç»™äº†offerï¼Œå½“æ—¶å·²ç»æœ‰å…¶ä»–åœ¨è€ƒè™‘çš„offerï¼Œå¾…é‡ä¹Ÿæ²¡å•¥ç«äº‰åŠ›ï¼Œé€šçŸ¥ç”µè¯é‡Œç›´æ¥æ‹’æ‰äº†ã€‚&lt;/li&gt;
&lt;li&gt;ä»Šæ—¥å¤´æ¡Â·åŸºç¡€æ¶æ„ï¼šå¤´æ¡çš„å†…æ¨åä¸½ä¸½çš„é”™è¿‡äº†ã€‚æ­£å¼æ ¡æ‹›æ˜¯ä¸‰è½®é¢è¯•ï¼Œå½“å¤©é¢è¯•äººä¹Ÿå¾ˆå¤šï¼Œä½†æ˜¯ç°åœºç»„ç»‡æ˜æ˜¾æ¯”æ»´æ»´å¥½å¤ªå¤šã€‚å› ä¸ºæŠ•é€’çš„å²—ä½å°±æ˜¯å¤§æ•°æ®å·¥ç¨‹å¸ˆï¼Œæ‰€ä»¥é¢è¯•çš„å†…å®¹æ¯”è¾ƒæœ‰é’ˆå¯¹æ€§ã€‚å’Œä¸‰é¢é¢è¯•å®˜èŠäº†å¾ˆå¤šå®é™…é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯åœ¨è¶…å¤§æ•°æ®é‡ï¼ˆBatch &amp;amp; Streamingä¸¤ç§æƒ…å†µï¼‰ä¸‹ï¼Œå¦‚ä½•è®¾è®¡å„ä¸ªå±‚æ¬¡ï¼Œè€Œä¸”ä¸åŒæ–¹æ¡ˆéƒ½ä¼šæœ‰å“ªäº›ä¼˜åŠ£ã€‚é¢è¯•å®˜ç»™å®šçš„åœºæ™¯æ¯”è¾ƒå…·ä½“ï¼Œä½†è€ƒå¯Ÿçš„èŒƒå›´å¾ˆå®½ï¼Œåœ¨è®¾è®¡æ–¹æ¡ˆæ—¶æ—¢è¦è€ƒè™‘ä¸åŒçš„åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œä¹Ÿè¦æŠŠè®¡ç®—æœºåº•å±‚çŸ¥è¯†è¿ç”¨èµ·æ¥ã€‚å’Œé¢è¯•å®˜çš„äº¤æµåŠ æ·±äº†æˆ‘å¯¹å·¥ä¸šç•Œæµ·é‡æ•°æ®åˆ†æçš„äº†è§£ï¼Œå¾ˆé•¿è§è¯†ï¼Œè€Œä¸”å¤´æ¡çš„æ•°æ®è§„æ¨¡å’Œé›†ç¾¤è§„æ¨¡éƒ½ç‰¹åˆ«å¤§ï¼Œå¯¹æˆ‘å¾ˆæœ‰å¸å¼•åŠ›ã€‚æœ€åæ‹¿åˆ°äº†å¤´æ¡æœ€é«˜æ¡£çš„offerï¼Œå¦‚æœDream offeræ²¡æ‹¿åˆ°æ‰‹çš„è¯ï¼Œåº”è¯¥æ˜¯æˆ‘çš„æœ€å¥½çš„é€‰æ‹©äº†ã€‚&lt;/li&gt;
&lt;li&gt;æœç‹ï¼šå‚åŠ å®Œç½‘æ˜“çš„é¢è¯•çš„å½“å¤©æ¥ç€å°±å»æœç‹å‚è§é¢è¯•ï¼Œæ€»å…±åªæœ‰ä¸¤é¢ï¼Œä¸»è¦æ˜¯é›†ä¸­åœ¨Sparkçš„æºç éƒ¨åˆ†ï¼Œç­”çš„ä¸æ˜¯ç‰¹åˆ«å¥½ï¼Œå½“æ—¶å¯¹ä¸€äº›æ–°ç‰¹æ€§äº†è§£ä¸å¤Ÿæ·±åˆ»ã€‚é¢è¯•çš„ç»„å¥½åƒå°±æ˜¯åœ¨åšSparkçš„ä¼˜åŒ–çš„ï¼Œå¥½åƒè¿˜æœ‰commiterã€‚äºŒé¢é¢è¯•å®˜è¿˜é—®æˆ‘ä¸ºä»€ä¹ˆæ²¡æœ‰åœ¨Sparkç¤¾åŒºåšè´¡çŒ®ï¼Œè®©æˆ‘æ„Ÿè§‰è‡ªå·±å¾ˆlowã€‚æœ€åæ‹¿åˆ°äº†offerï¼Œä½†æ—¶é—´æ¯”è¾ƒæ™šï¼Œä¹Ÿæ˜¯ç›´æ¥æ‹’æ‰äº†ã€‚&lt;/li&gt;
&lt;li&gt;å®œä¿¡Â·å¤§æ•°æ®ï¼šå®œä¿¡å‰åå»äº†ä¸¤æ¬¡é¢å®Œçš„ï¼Œç¬¬äºŒæ¬¡é¢è¯•ç”±äºæ—¶é—´å†²çªæ²¡å»æˆï¼Œä»¥ä¸ºæ²¡æœ‰æœºä¼šäº†ä½†æ˜¯HRè¿˜æ˜¯ç§¯æäº‰å–äº†ç¬¬äºŒæ¬¡é¢è¯•çš„æœºä¼šã€‚ä¸€å…±ä¸‰é¢æŠ€æœ¯é¢ï¼Œé¢è¯•çš„ç®—æ³•é¢˜ç‰¹åˆ«å¤šï¼Œå„ä¸ªé¢è¯•å®˜è®©å†™äº†ä»£ç ã€‚é—®çš„é—®é¢˜å¤§éƒ½å’Œæœºå™¨å­¦ä¹ æ•°æ®æŒ–æ˜ç›¸å…³ï¼Œå’Œä¸‰é¢é¢è¯•å®˜èŠäº†äº›åˆ†å¸ƒå¼è®¡ç®—çš„é—®é¢˜ï¼Œäº†è§£åˆ°å®œä¿¡çš„åˆ†å¸ƒå¼å¹³å°æ­å»ºåœ¨è‡ªå·±å¼€å‘çš„ç§æœ‰äº‘ä¸Šï¼Œæ„Ÿè§‰æŠ€æœ¯èƒ½åŠ›è¿˜æ˜¯å¾ˆå¼ºçš„ã€‚æœ€åç»™çš„offerè¿˜æ˜¯å¾ˆè¯±äººçš„ï¼Œè€Œä¸”æœ‰æˆ·å£æœºä¼šï¼Œè¿˜æ˜¯ä¸é”™çš„é€‰æ‹©ã€‚&lt;/li&gt;
&lt;li&gt;ç¾å›¢ç‚¹è¯„ï¼šç”±å­¦é•¿ç›´æ¥æ¨åˆ°ç¾å›¢ç‚¹è¯„Sparkå›¢é˜Ÿçš„ã€‚å› ä¸ºä¹‹å‰çœ‹äº†è¿™ä¸ªå›¢é˜Ÿçš„å‡ ç¯‡æŠ€æœ¯åšæ–‡ï¼Œäº†è§£åˆ°è¿™é‡Œçš„ä¸šåŠ¡å’Œå¹³å°è§„æ¨¡å¾ˆå¤§ï¼ŒæŠ€æœ¯èƒ½åŠ›å’Œç»éªŒä¹Ÿä¸é”™ï¼Œç›´æ¥å°±å¥”ç€è¿™ä¸ªå›¢é˜Ÿæ¥äº†ã€‚ä¸€å…±å››é¢ï¼Œæœ€åä¸€è½®æ˜¯ååŠ çš„ã€‚å‰ä¸‰é¢ä¹Ÿæ˜¯å…ˆä»å†™ä»£ç å¼€å§‹ï¼Œæœ€åä¸»è¦èŠäº†èŠä¹‹å‰å®ä¹ çš„é¡¹ç›®ï¼Œè¿˜æœ‰ä¸€äº›Sparkçš„ä¼˜åŒ–é—®é¢˜ã€‚ä¸‰é¢æœ‰ä¸€ä¸ªä»£ç é¢˜æ²¡å›ç­”å‡ºæ¥ï¼Œä½†æ˜¯å…¶ä»–é—®é¢˜å›ç­”çš„è¿˜è¡Œã€‚é¢è¯•å’Œç»™offerçš„æ—¶é—´éƒ½æ¯”è¾ƒæ™šï¼Œå› ä¸ºè–ªæ°´é—®é¢˜æƒ³ç›´æ¥æ‹’æ‰ï¼Œä½†æ˜¯HRå¾ˆçƒ­å¿ƒçš„ç”³è¯·äº†æœ€é«˜æ¡£çš„offerï¼Œä½†æ˜¯éœ€è¦è·¨éƒ¨é—¨çš„é¢†å¯¼å†é¢ä¸€è½®ã€‚è¿™ä¸€è½®ä¹Ÿæ˜¯ä¸»è¦èŠå¾—é¡¹ç›®ã€‚æœ€åèƒ½ç»™çš„æœ€é«˜çš„offerä¹Ÿæ²¡å¤ªæœ‰ç«äº‰åŠ›ï¼Œåªèƒ½å¾ˆé—æ†¾çš„æ‹’æ‰äº†ã€‚&lt;/li&gt;
&lt;li&gt;Freewheelï¼šè®ºå›å­¦é•¿å¸®å¿™æ¨çš„ï¼Œä¸€å…±ä¸‰é¢ï¼Œæœ€åä¸€é¢çš„Leaderæœ‰åˆ«çš„äº‹ï¼Œå¾ˆå¿«å°±ç»“æŸäº†ã€‚ä¸»è¦é¢è¯•å†…å®¹ä¹Ÿæ˜¯å…ˆä»ä»£ç é¢˜å¼€å§‹ï¼Œå†æ¬¡å¼ºè°ƒä¸€ä¸‹ï¼Œåˆ·é¢˜å¾ˆé‡è¦(x3)ï¼Œè€Œä¸”è¦æ³¨æ„è¾¹ç•Œé—®é¢˜å’Œä»£ç è§„èŒƒæ€§ã€‚å’ŒäºŒé¢é¢è¯•å®˜èŠå¾—æ¯”è¾ƒæŠ•æœºï¼ŒèŠäº†ä¸€äº›å½“å‰ä»–åœ¨åšçš„é¡¹ç›®ã€ç›¸åº”çš„æŠ€æœ¯é€‰å‹ä»¥åŠå¯èƒ½çš„é—®é¢˜ã€‚æœ€åä¹Ÿæ‹¿åˆ°äº†offerã€‚ä¸è¿‡Freewheelçš„æ•°æ®åˆ†æé›†ç¾¤è§„æ¨¡ç›¸å¯¹è¾ƒå°ã€‚&lt;/li&gt;
&lt;li&gt;å•†æ±¤ç§‘æŠ€ï¼šçº¿ä¸‹ç¬”è¯•+å››è½®é¢è¯•ã€‚ç¬”è¯•è€ƒå¾—æŒºæ³›ï¼Œä»£ç é¢˜å†™å¾—è¿˜è¡Œï¼Œæƒ³å‡ºæ¥ä¸€ç§æ—¶é—´å¤æ‚åº¦æœ€ä½çš„ç®—æ³•ã€‚HRæœ€å¼€å§‹å®‰æ’çš„ä¸¤è½®é¢è¯•å®˜ä¸å¤ªmatchï¼Œä¸»è¦æ˜¯åšåå°å¼€å‘çš„ï¼Œå¯¹åˆ†å¸ƒå¼å¹³å°ä¸å¤ªç†Ÿæ‚‰ã€‚äºŒé¢ç»“æŸååœ¨å›å­¦æ ¡çš„è·¯ä¸ŠHRå¾—åˆ°ä¹‹å‰é¢è¯•å®˜çš„åé¦ˆåé‡æ–°å®‰æ’äº†å¯¹å£çš„é¢è¯•å®˜ã€‚ç¬¬äºŒæ¬¡è¿‡æ¥é¢è¯•çš„å†…å®¹é›†ä¸­åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿçš„åŸºæœ¬çŸ¥è¯†å’Œä¸€è‡´æ€§åè®®ä¸Šï¼Œä¸‰é¢é¢è¯•å®˜æŒ–è¿‡æ¯”ç‰¹å¸ï¼Œè¿˜èŠäº†BlockChainçš„å…·ä½“æŠ€æœ¯ç»†èŠ‚ã€‚å››é¢é¢è¯•å®˜è¿˜ä»‹ç»äº†å•†æ±¤åœ¨å¤§è§„æ¨¡å›¾åƒè¯†åˆ«ï¼Œä»¥åŠè§†é¢‘å›¾ç‰‡åˆ†å¸ƒå¼å­˜å‚¨ã€ç´¢å¼•çš„å·¥ä½œå†…å®¹ï¼Œå¾ˆæœ‰å¯å‘ã€‚å•†æ±¤offerå‘ä¸‹æ¥ä¹‹åï¼Œä¸‰é¢é¢è¯•å®˜å•ç‹¬çº¦æˆ‘åƒé¥­èŠäº†èŠï¼Œå¬è¯´æˆ‘åœ¨ç­‰MSRAæ¶ˆæ¯ä¹‹åï¼Œè¿˜æå‡ºè§ä¸€ä¸‹å¤§bossã€‚æœ€åMSRA offeråˆ°æ‰‹åï¼Œæ€•æœ‰è®¨ä»·è¿˜ä»·ä¹‹å«Œï¼Œè¿˜æ˜¯æ”¾å¼ƒäº†è¿™ä¸ªæœºä¼šï¼Œä¸»è¦è¿˜æ˜¯åšæŒæƒ³æ¥MSRAçš„é—æ„¿ï¼Œä½†æ˜¯åæ¥æ„Ÿè§‰åæ‚”äº†ï¼Œè§ä¸€é¢èŠä¸€èŠä¹Ÿæ²¡å•¥ï¼Œå…³é”®èƒ½é•¿è§è¯†å‘€ã€‚&lt;/li&gt;
&lt;li&gt;MSRAï¼šæœ€åç»ˆäºè¦èŠåˆ°å¾®è½¯äºšæ´²ç ”ç©¶é™¢äº†ã€‚é¢è¯•èµ°çš„å®ä¹ ç”Ÿç»¿è‰²é€šé“ï¼Œæ¯”æ ¡æ‹›å°‘ä¸€è½®é¢è¯•ï¼Œå†åŠ ä¸Šmentorå¼ºæ¨æˆ‘ï¼Œåˆå°‘äº†ä¸€è½®é¢è¯•ï¼Œå› æ­¤æ€»å…±æœ‰ä¸‰é¢ï¼ˆæ ¡æ‹›æ˜¯5é¢ï¼‰ï¼šæŠ€æœ¯é¢+Researché¢+AAé¢ã€‚å¾®è½¯çš„é¢è¯•è¿˜æ˜¯å€¾å‘äºå†™ä»£ç çš„ï¼Œè¿™ä¸ªæå‰æœ‰æ€æƒ³å‡†å¤‡ï¼Œä½†æ˜¯åœ¨Researché¢æ—¶è¿˜æ˜¯æ ½äº†ã€‚åœ¨ä¸€é“æˆ‘è®¤ä¸ºå¾ˆç®€å•çš„é—®é¢˜ä¸Šï¼Œé¢è¯•å®˜ä¸€ç›´è¿½é—®è¿˜æœ‰æ²¡æœ‰ä¼˜åŒ–æ–¹æ³•ã€è¿˜æœ‰æ²¡æœ‰å¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹ã€‚æœ€åæˆ‘å®åœ¨ç­”ä¸ä¸Šæ¥äº†ï¼Œé¢è¯•å®˜æç¤ºäº†å¯ä»¥è€ƒè™‘CPUå¯»å€å’Œå†…å­˜å¯¹é½é—®é¢˜ã€‚ã€‚åœ¨Researcheré¢å‰æ¯”è¾ƒæ˜æ˜¾çš„æš´éœ²äº†æˆ‘çš„çŸ­æ¿ï¼Œä¸æ˜¯è®¡ç®—æœºç§‘ç­å‡ºèº«ï¼Œæ€è·¯ä¸å¤Ÿå¼€é˜”ï¼Œä¸€ç›´é™·å…¥ç®—æ³•æœ¬èº«çš„ä¼˜åŒ–ï¼Œæ²¡æœ‰æƒ³åˆ°è¿ç”¨è®¡ç®—æœºç³»ç»Ÿçš„çŸ¥è¯†ã€‚å…¶ä»–ä»£ç é¢˜å›ç­”çš„è¿˜å¯ä»¥ï¼Œé¡¹ç›®èŠå¾—æ¯”è¾ƒå¤šï¼Œè®²é¡¹ç›®çš„æ—¶å€™æˆ‘æ„Ÿè§‰ä¸€ç›´è¢«é‚£ä½researcher challenge(ğŸ˜…)ã€‚ä¹‹åçš„AAé¢ç›¸å¯¹è½»æ¾ä¸€äº›ï¼Œç”°è€å¤§è¿˜æ˜¯å¾ˆNiceåœ°èŠäº†äº›åœ¨ç ”ç©¶é™¢åšRSDEçš„ç‰¹ç‚¹å’Œä¸åŒã€‚æœ€åå¾ˆå¹¸è¿çš„æ‹¿åˆ°äº†è¿™ä¸ªDream offerã€‚æ‹¿åˆ°è¿™ä¸ªofferä¹‹åï¼ŒåŠæ—¶åœ°å’Œå‡ ä¸ªä¸€ç›´åœ¨è€ƒè™‘å…¬å¸è§£é‡Šäº†æƒ…å†µï¼Œæ‹’æ‰äº†ä»–ä»¬çš„offerï¼Œä¹Ÿç‰¹åˆ«æ„Ÿè°¢è¿™äº›å…¬å¸çš„é’çå’Œç†è§£ã€‚è‡³æ­¤ï¼Œæˆ‘çš„æ±‚èŒå­£å°±æ­£å¼ç»“æŸäº†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;å°¾å£°&lt;/h2&gt;
&lt;p&gt;æ±‚èŒå­£ä¹Ÿå°±ä¸‰å››ä¸ªæœˆï¼Œä½†æ¯å¤©å°±åƒæ‰“ä»—ä¸€æ ·ï¼Œå°¤å…¶æ˜¯ä¸€å¤©é¢å¤šå®¶æ—¶ä¼šç‰¹åˆ«ç–²æƒ«ã€‚ç‰¹åˆ«æ„Ÿè°¢æˆ‘çš„çˆ¸å¦ˆå’Œç›¼ç›¼å¯¹æˆ‘çš„é¼“åŠ±å’Œæ”¯æŒã€‚&lt;/p&gt;
&lt;p&gt;æ±‚èŒç»“æŸä¹Ÿæ„å‘³ç€æˆ‘çš„èŒåœºç”Ÿæ¶¯å³å°†å¼€å¯ï¼Œæ–°çš„å¾ç¨‹åœ¨ç­‰ç€æˆ‘ã€‚&lt;/p&gt;</summary></entry><entry><title>å¿™å¿™ç¢Œç¢Œ æˆ‘çš„2016</title><link href="http://www.guozhongxin.com/pages/2017/04/28/summary2016.html" rel="alternate"></link><updated>2017-04-28T23:00:00+08:00</updated><author><name>guozhongxin</name></author><id>tag:www.guozhongxin.com,2017-04-28:pages/2017/04/28/summary2016.html</id><summary type="html">&lt;h2&gt;2016&lt;/h2&gt;
&lt;p&gt;2016å¯¹äºæˆ‘æ˜¯æ³¨å®šå¿™ç¢Œçš„ä¸€å¹´ã€‚&lt;/p&gt;
&lt;p&gt;ç›´åˆ°æ‹¿åˆ°dream offerå‰ï¼Œæ‰‹ä¸ŠåŒæ—¶éƒ½ä¼šæœ‰å¤šæ–¹é¢çš„å·¥ä½œè¦åšã€‚ç¬¬ä¸€ç ”ç©¶ç”Ÿæ¯•ä¸šæ‰€éœ€è¦çš„å°è®ºæ–‡ä¸èƒ½å†æ‹–äº†ï¼›ç¬¬äºŒï¼Œ17å¹´æ¯•ä¸šçš„æˆ‘è¦å¼€å§‹æ‰¾å®ä¹ ï¼Œå¹¶å‡†å¤‡æ‰¾å·¥ä½œäº†ï¼›ç¬¬ä¸‰æ¯•ä¸šè®¾è®¡ä¹Ÿè¦åœ¨å¹´åº•å‰å®Œæˆæ‰€æœ‰å·¥ä½œï¼›ç¬¬å››ï¼Œå®éªŒå®¤çš„é¡¹ç›®ï¼Œä»¥åŠé›†ç¾¤ç®¡ç†çš„æ—¥å¸¸å·¥ä½œéƒ½éœ€è¦æˆ‘ä¸€ç›´å‚ä¸ã€‚&lt;/p&gt;
&lt;h3&gt;1.å®ä¹ ï¼šå’ŒMSRAçš„ç¬¬ä¸€æ®µç¼˜åˆ†&lt;/h3&gt;
&lt;p&gt;æ˜¥èŠ‚å‰å­¦é•¿å†…æ¨æˆ‘å»å¾®è½¯äºšæ´²ç ”ç©¶é™¢å®ä¹ ã€‚é¢è¯•çš„ç»„æ­£åœ¨åšåˆ†å¸ƒå¼è®¡ç®—çš„ç›¸å…³ç ”ç©¶ï¼Œè¦åŸºäºSparkæºç åšå¼€å‘ï¼Œé¢è¯•çš„å†…å®¹ä¸»è¦å’ŒSparkç›¸å…³ã€‚å½“æ—¶é¢è¯•å®˜ï¼Œä¹Ÿæ˜¯åæ¥çš„åŒäº‹chenyangã€gaoyanjieï¼Œæ‹¿äº†ä¸€ä¸ªç¬”è®°æœ¬è¿‡æ¥ï¼Œç›´æ¥å¯¹ç€Sparkæºç å¼€å§‹æé—®ã€‚æ•´ä½“ä¸Šé¢è¯•å†…å®¹æ­£åˆæˆ‘èƒƒå£ï¼Œä¹Ÿå°±æœ‰å¹¸æ‹¿åˆ°äº†MSRAçš„å®ä¹ æœºä¼šã€‚&lt;/p&gt;
&lt;p&gt;åœ¨MSRAçš„å‰åŠæ®µæ—¶é—´é‡Œï¼Œæˆ‘å‚ä¸åˆ°äº†TR-Sparkçš„å·¥ä½œä¸­æ¥ã€‚ç®€å•æ¥è¯´ï¼ŒTR-Sparkæ˜¯åœ¨ä¸€ç§éå¸¸ä¸ç¨³å®šçš„äº‘ç¯å¢ƒï¼ˆ&lt;code&gt;Transient Resource&lt;/code&gt;ï¼‰ä¸‹ï¼Œä¾ç„¶èƒ½ç¨³å®šå·¥ä½œçš„åˆ†å¸ƒå¼è®¡ç®—å¹³å°ï¼Œæ˜¯å½“æ—¶çš„ä»£ç åœ¨Spark 1.5.2ç‰ˆæœ¬ä¸Šè¿›è¡ŒäºŒæ¬¡å¼€å‘çš„ã€‚è¿™ç§ä¸ç¨³å®šçš„äº‘ç¯å¢ƒæ˜¯ä¸€äº›éå¸¸å»‰ä»·çš„äº‘ä¸»æœºï¼Œä¼šåœ¨å…¶ä»–ç§Ÿæˆ·ç”³è¯·èµ„æºæ—¶è¢«ä¸»åŠ¨é‡Šæ”¾æ‰ï¼Œä»¥ä¾›è¿™äº›â€œé«˜çº§â€ç§Ÿæˆ·ä½¿ç”¨ï¼Œè™½ç„¶ä¸ç¨³å®šï¼Œä½†ä¹Ÿç›¸å½“å»‰ä»·ã€‚TR-Sparkåœ¨è¿™ç§ç¯å¢ƒä¸‹ï¼Œé€šè¿‡resource stability and data size reduction-aware schedulingï¼Œä»¥åŠ lineage-aware checkpointingä¸¤å¤§ç­–ç•¥ç›¸ç»“åˆï¼Œæ™ºèƒ½çš„å¤‡ä»½Sparkè®¡ç®—çš„ä¸­é—´ç»“æœï¼ˆä¸¤ä¸ªStageä¹‹é—´è¿›è¡Œshuffleæ—¶çš„&lt;code&gt;block&lt;/code&gt;ï¼‰ï¼Œä»è€Œæé«˜äº†åˆ†å¸ƒå¼å¹³å°åœ¨Transient Resourceç¯å¢ƒä¸‹çš„é«˜å¯ç”¨æ€§[1]ã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹åï¼Œæˆ‘çš„mentorï¼Œyanyingè½¬å‘äº†åŒºå—é“¾&lt;code&gt;BlockChain&lt;/code&gt;çš„ç ”ç©¶ã€‚æˆ‘è¿˜è®°å¾—çš„æœ€å¼€å§‹çš„æ—¶å€™ï¼Œyingå§æ‹‰æˆ‘åˆ°ä¸€ä¸ªè®¨è®ºå®¤é‡Œâ€œå®‰åˆ©â€æˆ‘ä»€ä¹ˆæ˜¯BlockChainï¼Œè¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡å¬è¯´è¿™ä¸ªæŠ€æœ¯ï¼Œå¬å¾—æˆ‘äº‘é‡Œé›¾é‡Œã€‚ç´§æ¥ç€ï¼Œyingå§ï¼Œchenyangå¸¦ç€æˆ‘å¼€å§‹çœ‹å„ç§ç›¸å…³BlockChainå¼€æºé¡¹ç›®çš„ç™½çš®ä¹¦ï¼Œå¼€å§‹ç ”ç©¶BlockChainåˆ°åº•æ˜¯ä»€ä¹ˆã€‚åˆšæ¥è§¦æ–°äº‹ç‰©çš„æˆ‘ä¼šæ¯”è¾ƒè¿·èŒ«ï¼Œä¸çŸ¥é“ä»ä½•çœ‹èµ·ï¼Œè€Œä¸”æœ‰æ—¶ä¼šgetä¸åˆ°ä¸¤ä½researcherçš„ç‚¹ã€‚åœ¨yingå§çš„å¼ºæœ‰åŠ›çš„æŒ‡å¯¼å’Œpushä¸‹ï¼Œæˆ‘ä»¬æŠ½ä¸å‰¥èŒ§ï¼Œä¸€æ­¥æ­¥ç†è§£BlockChainæŠ€æœ¯æ ¸å¿ƒã€‚å®é™…ä¸­æˆ‘ä»¬æ˜¯ä»BigchainDBæºç å¼€å§‹ï¼Œäº†è§£BlockChainè¿ä½œçš„æ•´ä¸ªæµç¨‹ã€‚å¹¶åŸºäºBigchainDBåšäº†ä¸€ä¸ªåŸºäºBlockChainçš„æ…ˆå–„ç³»ç»Ÿï¼ˆBlockChain for Charityï¼‰ï¼Œå‚åŠ äº†å¾®è½¯çš„Hackathonã€‚ç”±äºåœ¨ä¸åƒå¤§å¤šæ•°BlockChainä¸Šéƒ½æ˜¯è™šæ‹Ÿè´§å¸ï¼Œåœ¨æ…ˆå–„ç³»ç»Ÿä¸­è®°å½•çš„å¯èƒ½æ˜¯å®é™…è´§å¸ï¼Œç”šè‡³æ˜¯ç‰©å“ï¼Œå› æ­¤æˆ‘åœ¨BigchainDBä¸Šåšäº†ä¸€ä¸ªtx receiverè¦è¿›è¡Œç¡®è®¤çš„æœºåˆ¶ã€‚åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå‘ç°BigchainDBçš„æ•´ä½“æ¶æ„å’Œä¸»æµçš„åŒºå—é“¾é¡¹ç›®æœ‰æ˜æ˜¾å·®å¼‚ï¼šBigchainDBæ˜¯å»ºç«‹åœ¨ä¸€ä¸ªåˆ†å¸ƒå¼çš„æ•°æ®åº“ä¸Šï¼Œè€Œä¸æ˜¯å„è‡ªèŠ‚ç‚¹åˆ†åˆ«maintainä¸€ä¸ªæ•°æ®åº“ï¼Œå› æ­¤è™½ç„¶ä¸ç”¨è€ƒè™‘æ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜ä»è€Œæé«˜äº†Throughputï¼Œä½†æ˜¯ä¹Ÿç»™æ•´ä¸ªç³»ç»Ÿå¸¦æ¥äº†å®‰å…¨ä¸Šçš„é£é™©ã€‚è¿™ä¸€å·®å¼‚å„æœ‰ä¼˜åŠ£ã€‚ä¹‹åæˆ‘ä»¬åˆå¼€å§‹ç ”ç©¶Ethereumï¼Œä¸€ä¸ªä¸»æµçš„BlockChainé¡¹ç›®ï¼Œæˆ‘é‡ç‚¹å…³æ³¨äº†Smart Contractæ–¹é¢çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ä»16å¹´2æœˆåº•åˆ°9æœˆåˆï¼Œå…­ä¸ªæœˆå¤šçš„æ—¶é—´è¿‡å¾—å¾ˆå¿«ï¼Œä¹Ÿå¾ˆå……å®ã€‚æœ€å¹¸è¿çš„æ˜¯æœ‰ä¸€ä¸ªè¶…çº§æ£’çš„mentorï¼Œåœ¨å„ä¸ªæ–¹é¢ç»™æˆ‘å¾ˆå¤šæŒ‡å¯¼å’Œæœºä¼šï¼Œè‡ªå·±å—ç›ŠåŒªæµ…ã€‚å®ä¹ æœŸé—´åˆä½œçš„ä¸¤ä½åŒäº‹ï¼ŒSparkä¸“å®¶yanjieï¼Œåšå­¦çš„chenyangï¼Œè¿˜æœ‰è€æ¿Thomasï¼Œä¹Ÿéƒ½è®©æˆ‘å¯¹MSRAå……æ»¡äº†å´‡æ‹œã€‚&lt;/p&gt;
&lt;h3&gt;2.å°è®ºæ–‡ï¼šä¸€æ³¢ä¸¤æŠ˜&lt;/h3&gt;
&lt;p&gt;åˆ°äº†16å¹´æˆ‘çš„å°è®ºæ–‡ä¸èƒ½å†æ‹–äº†ï¼Œæ˜¥èŠ‚æœŸé—´æŠŠè®ºæ–‡æ€è·¯æ•´ç†é‡Œä¸€ä¸‹ï¼Œç ”äºŒä¸‹å­¦æœŸå¼€å­¦å›æ¥å°±å¼€å§‹åŠ¨ç¬”äº†ã€‚&lt;/p&gt;
&lt;p&gt;å°è®ºæ–‡ä¸»è¦ç ”ç©¶å†…å®¹æ˜¯é’ˆå¯¹åˆ†å¸ƒå¼è®¡ç®—å¹³å°çš„æ€§èƒ½ç“¶é¢ˆè¿›è¡Œåˆ†æã€å»ºæ¨¡ã€‚æ‰€è°“æ€§èƒ½ç“¶é¢ˆä¸»è¦æ˜¯æŒ‡åˆ†å¸ƒå¼ä½œä¸šæ‰§è¡ŒæœŸé—´ï¼Œé›†ç¾¤èµ„æºçš„æœ‰é™æ€§å¯¹æ‰§è¡Œæ•ˆç‡çš„å½±å“ã€‚æœ€åˆçš„ç‚¹æ˜¯IBMç ”ç©¶é™¢å®ç°æ—¶çš„mentorï¼Œå·¨ä¼Ÿæå‡ºçš„ï¼Œæˆ‘é›¶é›¶æ•£æ•£åšäº†è¿‘ä¸€å¹´çš„æ—¶é—´ã€‚é¦–å…ˆæ˜¯å°†æ€§èƒ½ç“¶é¢ˆè¿›è¡Œé‡åŒ–ï¼ŒæŠŠæ€§èƒ½åˆ†æä»å®šæ€§åˆ†æé—®é¢˜å˜æˆé‡åŒ–æŒ‡æ ‡ã€‚å†é€šè¿‡è®¡ç®—å¹³å°logä¸­çš„metricså¯¹æ€§èƒ½ç“¶é¢ˆæŒ‡æ ‡è¿›è¡Œå»ºæ¨¡ï¼Œå¾—åˆ°ä¸€ä¸ªé€‚ç”¨äºä¸åŒé›†ç¾¤ã€ä¸åŒç±»å‹ä½œä¸šçš„æ€§èƒ½ç“¶é¢ˆæ¨¡å‹ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å°è®ºæ–‡ä¸Šï¼Œä¸»è¦ä»ä¸€ä¸ªå’Œæˆ‘è‡ªå·±å¯¼å¸ˆæœ‰åˆä½œå…³ç³»çš„è€å¸ˆé‚£é‡Œå¾—åˆ°äº†ä¸€äº›æŒ‡å¯¼ï¼Œä½†å¥¹å¯¹ç ”ç©¶å†…å®¹æœ¬èº«æ²¡æœ‰å¤ªå¤šäº†è§£ã€‚ç¬¬ä¸€ç‰ˆçš„è®ºæ–‡å†™å¾—å¾ˆæ½¦è‰ï¼ŒæŠ•äº†CIKMï¼Œç­‰äº†ä¸¤ä¸ªæœˆä¹‹åæœ€åæ”¶åˆ°äº†4ä¸ªreviewï¼Œä¸¤ä¸ªacceptã€ä¸€ä¸ªborderlineã€ä¸€ä¸ªrejectï¼Œæœ€åå¾—åˆ°chairçš„rejectã€‚ä¸€èˆ¬cikméƒ½æ˜¯3ä¸ªreviewerï¼Œçœ‹æ¥åœ¨æœ€å¼€å§‹çš„reviewä¸­åˆ†æ­§è¾ƒå¤§ï¼Œå¤šåŠ äº†ä¸€ä¸ªã€‚è¿™äº›reviewå¾ˆçŠ€åˆ©ï¼Œä¹Ÿå¾ˆåˆ°ä½ï¼Œä¸å¾—ä¸æœã€‚&lt;/p&gt;
&lt;p&gt;åœ¨åšäº†ç›¸å¯¹åº”çš„ä¿®æ”¹å’Œè°ƒæ•´åï¼Œæˆ‘å’Œå¯¼å¸ˆå°±æŠ•ç¨¿ä¼šè®®äº§ç”Ÿäº†åˆ†æ­§ï¼Œå¯¼å¸ˆæƒ³è®©æˆ‘æŠ•VLDBè¿™æ ·çš„é¡¶ä¼šï¼Œæˆ‘ä¸æ€è¿›å–æ‰¾ä¸ªæ—¶é—´è¿‘çš„æ°´ä¼šå°±è¦æŠ•ï¼Œæœ€åå¯¼å¸ˆè¿˜æ˜¯æ”¾äº†æˆ‘ä¸€é©¬ï¼ŒæŠ•äº†HPCC: ã€‚åœ¨ä¿®æ”¹è®ºæ–‡æ—¶ï¼Œæˆ‘åœ¨MSRAå®ä¹ çš„ä¸¤ä½å°ä¼™ä¼´youerå’Œè¾°å“¥å¸®æˆ‘ä¿®æ”¹è‹±æ–‡è¡¨è¾¾ï¼Œäº‹å®è¯æ˜ç•™å­¦çš„åšå£«å°±æ˜¯å¼ºã€‚æ„Ÿè§‰åœ¨MSRAè®¤è¯†çš„åšå£«éƒ½éå¸¸è®©æˆ‘ä½©æœï¼Œæ´—åˆ·äº†æˆ‘å¯¹åšå£«çš„naiveçš„åè§ï¼Œä¹Ÿåæ‚”å½“æ—¶æ€ä¹ˆæ²¡è€ƒè™‘è¯»åšå‘¢ã€‚ã€‚&lt;/p&gt;
&lt;h3&gt;3.æ‰¾å·¥ä½œï¼šå…œå…œè½¬è½¬å›åˆ°èµ·ç‚¹&lt;/h3&gt;
&lt;p&gt;ä¸»è¦è¿‡ç¨‹è®°å½•åœ¨è¿™ç¯‡åšæ–‡é‡Œï¼š&lt;a href="http://guozhongxin.com/pages/2017/05/02/jobhunting.html"&gt;è¿Ÿåˆ°çš„æ¯•ä¸šæ±‚èŒæ€»ç»“ï¼šå…œå…œè½¬è½¬å›åˆ°èµ·ç‚¹&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;4.æ¯•ä¸šè®¾è®¡&lt;/h3&gt;
&lt;p&gt;[1]Yan Y, Gao Y, Chen Y, et al. TR-Spark: Transient Computing for Big Data Analytics[C]// ACM Symposium on Cloud Computing(SoCC). ACM, 2016:484-496.&lt;/p&gt;
&lt;p&gt;[2]Guo Z, Hu Z, Zhang C, et al. Learning-Based Characterizing and Modeling Performance Bottlenecks of Big Data Workloads[C]//IEEE 18th International Conference on High Performance Computing and Communications(HPCC). IEEE, 2016: 860-867.&lt;/p&gt;</summary></entry><entry><title>åšå®¢é‡å¯</title><link href="http://www.guozhongxin.com/pages/2017/04/25/restart.html" rel="alternate"></link><updated>2017-04-25T23:00:00+08:00</updated><author><name>guozhongxin</name></author><id>tag:www.guozhongxin.com,2017-04-25:pages/2017/04/25/restart.html</id><summary type="html">&lt;h2&gt;å…³äºæ­¤åšå®¢&lt;/h2&gt;
&lt;p&gt;è¿™ä¸ªåšå®¢åˆšå¼€å§‹æ­å»ºæ—¶ï¼Œæˆ‘åˆšä¸Šç ”ç©¶ç”Ÿä¸ä¹…ã€‚é‚£æ—¶æˆ‘å¯¹äºå„ç§æŠ€æœ¯éƒ½å¾ˆæ‡µæ‡‚ï¼Œåˆå……æ»¡çƒ­æƒ…ã€‚æ­å»ºåšå®¢ä¹‹åˆï¼Œæˆ‘è¿˜è®¡åˆ’ç€æŠŠæˆ‘çš„æˆé•¿éƒ½è®°å½•åœ¨è¿™ï¼Œå› æ­¤ï¼Œå¯¹è¿™ä¸ªåšå®¢ä¹Ÿå……æ»¡çƒ­æƒ…ã€‚&lt;/p&gt;
&lt;p&gt;æ—©åœ¨2013å¹´åº•ï¼Œå½“æ—¶å¤§å››çš„æˆ‘æœ‰å¹¸è¿›å…¥äº†IBMä¸­å›½ç ”ç©¶é™¢ï¼Œå‰ååšäº†æ¥è¿‘ä¸€å¹´çš„å®ä¹ ç”Ÿã€‚æ­£æ˜¯è¿™æ®µç»å†ï¼Œæˆ‘å¼€å§‹æ¥è§¦å¹¶å­¦ä¹ åˆ†å¸ƒå¼å¹³å°ï¼Œç‰¹åˆ«è¦æ„Ÿè°¢æˆ‘çš„mentorï¼Œå·¨ä¼Ÿï¼Œç»™è¿˜æ˜¯å°ç™½çš„æˆ‘æä¾›äº†å¾ˆå¤šå¸®åŠ©å’ŒæŒ‡å¯¼ï¼Œè®©æˆ‘åœ¨çŸ¥è¯†ä¹‹å¤–å­¦ä¹ åˆ°ç ”ç©¶çš„åŸºæœ¬æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;é‚£æ—¶â€œå¤§æ•°æ®â€çš„æ¦‚å¿µåˆšå¼€å§‹ç‚’ä½œï¼ŒHadoopå·²ç»æ¨å¹¿å¼€æ¥ï¼ŒSparkæ–¹å…´æœªè‰¾ï¼Œæˆ‘ä¹ŸæŠŠåˆ†å¸ƒå¼æŠ€æœ¯ä½œä¸ºæˆ‘è¯»ç ”æœŸé—´çš„ä¸»è¦æ–¹å‘ã€‚å½“æ—¶å°±æƒ³ç€ï¼ŒæŠŠæˆ‘åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­çš„æ”¶è·å’Œä½“ä¼šéƒ½è®°å½•åœ¨è¿™ï¼Œç§¯å°‘æˆå¤šï¼Œä¸€å®šæ˜¯ä¸€ä¸ªå€¼å¾—æœŸå¾…çš„äº‹æƒ…ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯åœ¨å†™äº†å‡ ç¯‡æ–‡ç« åï¼Œè¿™ç§çƒ­æƒ…å°±å‰Šå‡äº†ã€‚å¯èƒ½æ˜¯æˆ‘ä¹‹å‰å¯¹è‡ªå·±ã€å¯¹è¿™ä¸ªåšå®¢æœŸæœ›å¤ªé«˜äº†ï¼Œå†™å‡ºæ¥çš„ä¸œè¥¿å¹¶ä¸æ»¡æ„ï¼Œå¹³å¸¸å¿™(hao)äº(chi)å­¦(lan)ä¸š(zuo)ï¼Œæ²¡èƒ½æŒç»­æŠ•å…¥ç²¾åŠ›å»ç»´æŠ¤è¿™ä¸ªåšå®¢ã€‚ç‰¹åˆ«æ˜¯çœ‹åˆ°ä¸€äº›å¤§ç‰›çš„blogï¼Œè‡ªå·±çš„æ–‡ç« æ›´æ˜¯ç›¸å½¢è§ç»Œï¼Œä¹Ÿæ²¡å•¥æ–°æ„ã€‚æœ€åå¯¼è‡´äº†è¿™ä¸ªåšå®¢è’åºŸäº†ä¸¤å¹´é›¶ä¸‰ä¸ªæœˆã€‚&lt;/p&gt;
&lt;h2&gt;åšå®¢è’åºŸä¹‹åçš„æˆ‘&lt;/h2&gt;
&lt;p&gt;å…¶å®ï¼Œåšå®¢è’åºŸçš„è¿™ä¸¤å¹´å¤šï¼Œæ˜¯æˆ‘å¿«é€Ÿæˆé•¿ã€å˜åŒ–çš„é˜¶æ®µã€‚æ›´å…·ä½“çš„æ¥è¯´ï¼Œæˆ‘å®Œæˆäº†ç ”ç©¶ç”Ÿå­¦ä¸šï¼Œå¹¶å¼€å§‹äº†èŒä¸šç”Ÿæ¶¯ã€‚è¿™ä¸¤å¹´å¤šä¹Ÿæ˜¯æˆ‘ç»å†æœ€ä¸°å¯Œçš„é˜¶æ®µã€‚&lt;/p&gt;
&lt;h3&gt;Â· 2015&lt;/h3&gt;
&lt;p&gt;2015å¹´å…¨å¹´çš„æ—¶é—´åŸºæœ¬éƒ½æ˜¯åœ¨å®éªŒå®¤åšé¡¹ç›®ï¼Œä¹Ÿå¼€å§‹æ…¢æ…¢è¹­è¹­çš„åšäº›ç ”ç©¶ï¼Œæ‰¾è®ºæ–‡ç‚¹ã€‚ä¸»è¦çš„å·¥ä½œä¸€æ–¹é¢æ˜¯åœ¨æä¸€äº›æœºå™¨å­¦ä¹ ç®—æ³•çš„åˆ†å¸ƒå¼å®ç°ä¸Šï¼Œä¸€æ–¹é¢æ˜¯åœ¨åšä¸€äº›å®éªŒå®¤åˆ†å¸ƒå¼é›†ç¾¤çš„å®Œå–„å’Œæ€§èƒ½è°ƒä¼˜ä¸Šï¼Œè¿™ä¸ªé˜¶æ®µï¼Œç»å†Sparkä»1.2åˆ°1.5.2ï¼ˆåˆšæ‰ç‰¹åœ°å»å®˜ç½‘ä¸ŠéªŒè¯äº†ä¸€ä¸‹ï¼Œè¯æ˜æˆ‘çš„è®°å¿†æ²¡æœ‰åå·®ï¼‰ï¼Œç¤¾åŒºè¶Šæ¥è¶Šæ´»è·ƒï¼Œå‘¨è¾¹é¡¹ç›®é€æ¸ä¸°å¯Œèµ·æ¥ã€‚å®éªŒå®¤çš„æ•°æ®åˆ†æå·¥ä½œåŸºæœ¬ä¸Šéƒ½è·‘åœ¨Sparkä¸Šï¼ŒMLlibå’ŒGraphXçš„é€æ¸ä¸°å¯Œæä¾›äº†å¾ˆå¤§çš„å¸®åŠ©ã€‚&lt;/p&gt;
&lt;p&gt;ä»2014å¹´åº•å¼€å§‹æ¥è§¦è‚¡ç¥¨çš„æˆ‘ï¼Œåœ¨å°èµšä¸€ç¬”åè¿æ¥äº†15å¹´çš„â€œè‚¡ç¾â€ï¼Œä¸ä»…é‡‘é’±æŸå¤±ï¼Œä¹Ÿè€—è´¹äº†ä¸å°‘æ—¶é—´å’Œç²¾åŠ›ã€‚ç°åœ¨è™½æœªå®Œå…¨é€€å¸‚ï¼Œä½†åŸºæœ¬ä¸æŠ•å…¥ç²¾åŠ›äº†ï¼Œä¸€ä¸ªæœˆæ“ä½œä¸äº†å‡ æ¬¡ã€‚&lt;/p&gt;
&lt;h3&gt;Â· 2016&lt;/h3&gt;
&lt;p&gt;2016æ˜¯æˆ‘æœ€å¿™ç¢Œçš„ä¸€å¹´ï¼Œå†…å®¹å¤ªè¿‡â€œç²¾å½©â€ï¼Œå¦èµ·ä¸€ç¯‡è®°å½•å§ï¼š&lt;a href="http://guozhongxin.com/pages/2017/04/28/summary2016.html"&gt;å¿™å¿™ç¢Œç¢Œ æˆ‘çš„2016&lt;/a&gt;&lt;/p&gt;</summary></entry><entry><title>Spark DAGScheduleræ¨¡å—æºç è§£æ</title><link href="http://www.guozhongxin.com/pages/2015/01/25/spark_dagscheduler.html" rel="alternate"></link><updated>2015-01-25T21:00:00+08:00</updated><author><name>guozhongxin</name></author><id>tag:www.guozhongxin.com,2015-01-25:pages/2015/01/25/spark_dagscheduler.html</id><summary type="html">&lt;h2&gt;Spark DAGSchedulerçš„èƒŒæ™¯çŸ¥è¯†&lt;/h2&gt;
&lt;p&gt;Spark Applicationåœ¨é‡åˆ°actionç®—å­æ—¶ï¼ŒSparkContextä¼šç”ŸæˆJobï¼Œå¹¶å°†æ„æˆDAGå›¾å°†ç»™DAG Schedulerè§£ææˆStageã€‚&lt;/p&gt;
&lt;h3&gt;Stage&lt;/h3&gt;
&lt;p&gt;Stageæ˜¯Sparkå¯¹DAGçš„åˆ’åˆ†ï¼Œä»¥æ­¤ä½œä¸ºå¯¹ä½œä¸šçš„è¿›è¡Œä»»åŠ¡ï¼ˆtaskï¼‰åˆ’åˆ†å’Œè°ƒåº¦çš„ä¾æ®ã€‚&lt;br /&gt;
å¯ä»¥è¿™æ ·ç†è§£Stageä¸éœ€è¦shuffleæ˜¯å¯ä»¥éšæ„å¹¶å‘çš„, æ‰€ä»¥stageçš„è¾¹ç•Œå°±æ˜¯éœ€è¦shuffleçš„åœ°æ–¹ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹å›¾æ˜¯ä¸€ä¸ªstageä¾‹å­ã€‚
&lt;img alt="3" src="http://www.guozhongxin.com/images/stage.png" /&gt; &lt;/p&gt;
&lt;p&gt;Stageæœ‰ä¸¤ç§ï¼š &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ShuffleMapStage&lt;br /&gt;
  è¿™ç§Stageæ˜¯ä»¥Shuffleä¸ºè¾“å‡ºè¾¹ç•Œï¼Œå…¶è¾“å…¥è¾¹ç•Œå¯ä»¥æ˜¯ä»å¤–éƒ¨è·å–æ•°æ®ï¼Œä¹Ÿå¯ä»¥æ˜¯å¦ä¸€ä¸ªShuffleMapStageçš„è¾“å‡ºï¼Œå…¶è¾“å‡ºå¯ä»¥ã€‚æ˜¯å¦ä¸€ä¸ªStageçš„å¼€å§‹ShuffleMapStageçš„æœ€åTaskå°±æ˜¯ShuffleMapTaskã€‚åœ¨ä¸€ä¸ªJobé‡Œå¯èƒ½æœ‰è¯¥ç±»å‹çš„Stageï¼Œä¹Ÿå¯ä»¥èƒ½æ²¡æœ‰è¯¥ç±»å‹Stageã€‚&lt;br /&gt;
  ä¸Šå›¾Stage 1ï¼ŒStage 2éƒ½å±äºShuffleMapStage&lt;/li&gt;
&lt;li&gt;ResultStage&lt;br /&gt;
  è¿™ç§Stageæ˜¯ç›´æ¥è¾“å‡ºç»“æœã€‚å…¶è¾“å…¥è¾¹ç•Œå¯ä»¥æ˜¯ä»å¤–éƒ¨è·å–æ•°æ®ï¼Œä¹Ÿå¯ä»¥æ˜¯å¦ä¸€ä¸ªShuffleMapStageçš„è¾“å‡ºã€‚ResultStageçš„æœ€åTaskå°±æ˜¯ResultTaskã€‚åœ¨ä¸€ä¸ªJobé‡Œå¿…å®šæœ‰è¯¥ç±»å‹Stageã€‚ä¸€ä¸ªJobå«æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªStageï¼Œä½†è‡³å°‘å«æœ‰ä¸€ä¸ªResultStageã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;DAGScheduler&lt;/h3&gt;
&lt;p&gt;DAGSchedulerä¸»è¦åŠŸèƒ½å¦‚ä¸‹ï¼š  &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¥æ”¶ç”¨æˆ·æäº¤çš„job;&lt;/li&gt;
&lt;li&gt;å°†jobæ ¹æ®ç±»å‹åˆ’åˆ†ä¸ºä¸åŒçš„stageï¼Œè®°å½•å“ªäº›RDDã€Stageè¢«ç‰©åŒ–ï¼Œå¹¶åœ¨æ¯ä¸€ä¸ªstageå†…äº§ç”Ÿä¸€ç³»åˆ—çš„taskï¼Œå¹¶å°è£…æˆTaskSetï¼›&lt;/li&gt;
&lt;li&gt;å†³å®šæ¯ä¸ªTaskçš„æœ€ä½³ä½ç½®(ä»»åŠ¡åœ¨æ•°æ®æ‰€åœ¨çš„èŠ‚ç‚¹ä¸Šè¿è¡Œ)ï¼Œå¹¶ç»“åˆå½“å‰çš„ç¼“å­˜æƒ…å†µï¼›å°†TaskSetæäº¤ç»™TaskScheduler;&lt;/li&gt;
&lt;li&gt;é‡æ–°æäº¤Shuffleè¾“å‡ºä¸¢å¤±çš„Stageç»™TaskSchedulerï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ³¨ï¼šä¸€ä¸ªStageå†…éƒ¨çš„é”™è¯¯ä¸æ˜¯ç”±shuffleè¾“å‡ºä¸¢å¤±é€ æˆçš„ï¼ŒDAGScheduleræ˜¯ä¸ç®¡çš„ï¼Œç”±TaskSchedulerè´Ÿè´£å°è¯•é‡æ–°æäº¤taskæ‰§è¡Œï¼›&lt;/p&gt;
&lt;h2&gt;Spark DAGScheduleræºç è§£æ&lt;/h2&gt;
&lt;p&gt;DAGSchedulerçš„åˆ›å»ºæ˜¯åœ¨ç”¨æˆ·å®šä¹‰ä¸€ä¸ªæ–°çš„&lt;code&gt;SparkContext&lt;/code&gt;æ—¶è¿›è¡Œçš„ã€‚ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨SparkContextä¸­ï¼ŒTaskSchduleræ˜¯åœ¨DAGSchedulerä¹‹å‰ç”Ÿæˆçš„ï¼Œå³&lt;code&gt;dagScheduler = new DAGScheduler(this)&lt;/code&gt;ä¸­çš„this.taskSchedulerå·²ç»è¢«ç”Ÿæˆï¼Œè¿™ä¸ªtaskSchedulerä¹Ÿæ˜¯dagSchedulerçš„ä¸€ä¸ªæˆå‘˜å˜é‡ï¼‰&lt;/p&gt;
&lt;div class="source" style="font-family: Monaco, Consolas, 'Lucida Console', 'Courier New'; color: rgb(220, 220, 204); background-color: rgb(63, 63, 63);"&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;1&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;@volatile&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;private&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;spark&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;]&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;var&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;dagScheduler&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;DAGScheduler&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;_&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;2&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;try&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;3&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;dagScheduler&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;new&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;DAGScheduler&lt;/span&gt;(&lt;span style="color: rgb(227, 206, 171);"&gt;this&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;4&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;catch&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;5&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;case&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;e&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Exception&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;=&amp;gt;&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;throw&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;6&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;new&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;SparkException&lt;/span&gt;(&lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;DAGScheduler cannot be initialized due to %s&amp;quot;&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;format&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;e&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;getMessage&lt;/span&gt;))&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;7&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;p&gt;å½“æ‰§è¡Œ&lt;code&gt;è¾“å‡ºç®—å­&lt;/code&gt;çš„æ—¶å€™ï¼Œsparkä¼šè°ƒç”¨&lt;code&gt;sc.runJob()&lt;/code&gt;æ–¹æ³•ï¼Œä¾‹å¦‚&lt;code&gt;RDD.scala&lt;/code&gt;ä¸­å®šä¹‰çš„&lt;code&gt;count()&lt;/code&gt;:  &lt;/p&gt;
&lt;div class="source" style="font-family: Monaco, Consolas, 'Lucida Console', 'Courier New'; color: rgb(220, 220, 204); background-color: rgb(63, 63, 63);"&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;1&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;def&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;count&lt;/span&gt;()&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Long&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;sc&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;runJob&lt;/span&gt;(&lt;span style="color: rgb(227, 206, 171);"&gt;this&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;Utils&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;getIteratorSize&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;_&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;).&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;sum&lt;/span&gt;&lt;br&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;p&gt;è·Ÿè¿›åˆ°&lt;code&gt;SparkContext.scala&lt;/code&gt;ä¸­çš„&lt;code&gt;runJob()&lt;/code&gt;æ–¹æ³•ï¼Œå¯ä»¥çœ‹åˆ°ï¼š  &lt;/p&gt;
&lt;div class="source" style="font-family: Monaco, Consolas, 'Lucida Console', 'Courier New'; color: rgb(220, 220, 204); background-color: rgb(63, 63, 63);"&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;01&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;def&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;runJob&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;T&lt;/span&gt;, &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;U:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;ClassTag&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;](&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;02&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;rdd&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;RDD&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;T&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;],&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;03&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;func&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; (&lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;TaskContext&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Iterator&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;T&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;])&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&amp;gt;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;U&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;04&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;partitions&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Seq&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Int&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;],&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;05&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;allowLocal&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Boolean&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;06&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;resultHandler&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; (&lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Int&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;U&lt;/span&gt;) &lt;span style="color: rgb(227, 206, 171);"&gt;=&amp;gt;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;Unit&lt;/span&gt;) &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;07&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;if&lt;/span&gt; (&lt;span style="color: rgb(204, 120, 51);"&gt;dagScheduler&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;==&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;null&lt;/span&gt;) &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;08&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;throw&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;new&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;SparkException&lt;/span&gt;(&lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;SparkContext has been shutdown&amp;quot;&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;09&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;10&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;callSite&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;getCallSite&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;11&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;cleanedFunc&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;clean&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;func&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;12&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;logInfo&lt;/span&gt;(&lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;Starting job: &amp;quot;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;callSite&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;shortForm&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;13&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;start&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;System&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;nanoTime&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;14&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(204, 120, 51);"&gt;dagScheduler&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;runJob&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;rdd&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;cleanedFunc&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;partitions&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;callSite&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;allowLocal&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;15&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;resultHandler&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;localProperties&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;get&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;16&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;logInfo&lt;/span&gt;(&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;17&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;Job finished: &amp;quot;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;callSite&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;shortForm&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;, took &amp;quot;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; (&lt;span style="color: rgb(220, 220, 204);"&gt;System&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;nanoTime&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;-&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;start&lt;/span&gt;) &lt;span style="color: rgb(220, 220, 204);"&gt;/&lt;/span&gt; &lt;span style="color: rgb(140, 208, 211);"&gt;1&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;e9&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot; s&amp;quot;&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;18&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;rdd&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;doCheckpoint&lt;/span&gt;()&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;19&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;p&gt;&lt;code&gt;sc.runJob()&lt;/code&gt;æ˜¯è°ƒç”¨çš„&lt;code&gt;dagScheduler.runJob()&lt;/code&gt;æ–¹æ³•ã€‚è·Ÿè¿›åˆ°&lt;code&gt;DAGScheduler.runJob()&lt;/code&gt;&lt;/p&gt;
&lt;div class="source" style="font-family: Monaco, Consolas, 'Lucida Console', 'Courier New'; color: rgb(220, 220, 204); background-color: rgb(63, 63, 63);"&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;01&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;def&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;runJob&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;T&lt;/span&gt;, &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;U:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;ClassTag&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;](&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;02&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;rdd&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;RDD&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;T&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;],&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;03&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;func&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; (&lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;TaskContext&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Iterator&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;T&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;])&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&amp;gt;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;U&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;04&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;partitions&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Seq&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Int&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;],&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;05&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;callSite&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;CallSite&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;06&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;allowLocal&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Boolean&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;07&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;resultHandler&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; (&lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Int&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;U&lt;/span&gt;) &lt;span style="color: rgb(227, 206, 171);"&gt;=&amp;gt;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;Unit&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;08&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;properties&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Properties&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;null&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;09&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;10&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;start&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;System&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;nanoTime&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;11&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;waiter&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(204, 120, 51);"&gt;submitJob&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;rdd&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;func&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;partitions&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;callSite&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;allowLocal&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;resultHandler&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;properties&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;12&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;waiter&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;awaitResult&lt;/span&gt;() &lt;span style="color: rgb(227, 206, 171);"&gt;match&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;13&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;case&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;JobSucceeded&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&amp;gt;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;14&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;logInfo&lt;/span&gt;(&lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;Job %d finished: %s, took %f s&amp;quot;&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;format&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;15&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(&lt;span style="color: rgb(220, 220, 204);"&gt;waiter&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;jobId&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;callSite&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;shortForm&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; (&lt;span style="color: rgb(220, 220, 204);"&gt;System&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;nanoTime&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;-&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;start&lt;/span&gt;) &lt;span style="color: rgb(220, 220, 204);"&gt;/&lt;/span&gt; &lt;span style="color: rgb(140, 208, 211);"&gt;1&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;e9&lt;/span&gt;))&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;16&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;17&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;case&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;JobFailed&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;exception&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Exception&lt;/span&gt;) &lt;span style="color: rgb(227, 206, 171);"&gt;=&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;18&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;logInfo&lt;/span&gt;(&lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;Job %d failed: %s, took %f s&amp;quot;&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;format&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;19&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(&lt;span style="color: rgb(220, 220, 204);"&gt;waiter&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;jobId&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;callSite&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;shortForm&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; (&lt;span style="color: rgb(220, 220, 204);"&gt;System&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;nanoTime&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;-&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;start&lt;/span&gt;) &lt;span style="color: rgb(220, 220, 204);"&gt;/&lt;/span&gt; &lt;span style="color: rgb(140, 208, 211);"&gt;1&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;e9&lt;/span&gt;))&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;20&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;throw&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;exception&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;21&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;22&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;p&gt;å½“jobè¢«æ­£å¸¸æäº¤æ—¶ï¼Œ&lt;code&gt;submitJob()&lt;/code&gt;è¿”å›ä¸€ä¸ª&lt;code&gt;JobWaiter&lt;/code&gt;çš„ç±»ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ª&lt;strong&gt;&lt;code&gt;JobSubmitted&lt;/code&gt;&lt;/strong&gt;çš„&lt;code&gt;event&lt;/code&gt;ï¼ˆäº‹ä»¶ï¼‰&lt;/p&gt;
&lt;div class="source" style="font-family: Monaco, Consolas, 'Lucida Console', 'Courier New'; color: rgb(220, 220, 204); background-color: rgb(63, 63, 63);"&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;1&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;waiter&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;new&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;JobWaiter&lt;/span&gt;(&lt;span style="color: rgb(227, 206, 171);"&gt;this&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;jobId&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;partitions&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;size&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;resultHandler&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;2&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;eventProcessActor&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;!&lt;/span&gt; &lt;span style="color: rgb(204, 120, 51);"&gt;JobSubmitted&lt;/span&gt;(&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;3&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;jobId&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;rdd&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;func2&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;partitions&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;toArray&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;allowLocal&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;callSite&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;waiter&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;properties&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;4&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;waiter&lt;/span&gt;&lt;br&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;p&gt;DAGScheduleræ˜¯ä¸€ä¸ª&lt;strong&gt;ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹&lt;/strong&gt;ã€‚åœ¨DAGSchedulerçš„å®ä¾‹&lt;code&gt;dagScheduler&lt;/code&gt;åœ¨SparkContextä¸­è¢«åˆ›å»ºæ—¶ï¼Œ&lt;code&gt;dagScheduler&lt;/code&gt;åˆå§‹åŒ–äº†ä¸€ä¸ªå®ˆå€™è¿›ç¨‹ï¼Œç”¨æ¥å¯¹DAGSchedulerä¸­çš„å„ç§äº‹ä»¶è¿›è¡Œç›¸åº”ã€‚&lt;/p&gt;
&lt;div class="source" style="font-family: Monaco, Consolas, 'Lucida Console', 'Courier New'; color: rgb(220, 220, 204); background-color: rgb(63, 63, 63);"&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;1&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;private&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;def&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;initializeEventProcessActor&lt;/span&gt;() &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;2&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(127, 159, 127);"&gt;// blocking the thread until supervisor is started, which ensures eventProcessActor is&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;3&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(127, 159, 127);"&gt;// not null before any job is submitted&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;4&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;implicit&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;timeout&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;Timeout&lt;/span&gt;(&lt;span style="color: rgb(140, 208, 211);"&gt;30&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;seconds&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;5&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;initEventActorReply&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;6&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;dagSchedulerActorSupervisor&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;?&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;Props&lt;/span&gt;(&lt;span style="color: rgb(227, 206, 171);"&gt;new&lt;/span&gt; &lt;span style="color: rgb(204, 120, 51);"&gt;DAGSchedulerEventProcessActor&lt;/span&gt;(&lt;span style="color: rgb(227, 206, 171);"&gt;this&lt;/span&gt;))&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;7&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(204, 120, 51);"&gt;eventProcessActor&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;Await&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;result&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;initEventActorReply&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;timeout&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;duration&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;).&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;8&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;asInstanceOf&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;ActorRef&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;]&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;9&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;p&gt;&lt;code&gt;DAGSchedulerEventProcessActor&lt;/code&gt;è¿™ä¸ªclassåœ¨DAGScheduler.scalaä¸­è¢«å®šä¹‰ï¼Œç”¨æ¥æ¥å—å¹¶å¤„ç†DAGSchedulerå·¥ä½œæ—¶äº§ç”Ÿçš„å„ç§äº‹ä»¶&lt;code&gt;event&lt;/code&gt;,å¤„ç†çš„æ–¹æ³•æ˜¯è°ƒç”¨ä¼ å…¥çš„&lt;code&gt;dagScheduler&lt;/code&gt;ä¸­çš„æ–¹æ³•ã€‚&lt;code&gt;DAGSchedulerEventProcessActor&lt;/code&gt;å¤„ç†çš„äº‹ä»¶æœ‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;JobSubmitted&lt;/li&gt;
&lt;li&gt;StageCancelled&lt;/li&gt;
&lt;li&gt;JobCancelled&lt;/li&gt;
&lt;li&gt;JobGroupCancelled&lt;/li&gt;
&lt;li&gt;AllJobsCancelled&lt;/li&gt;
&lt;li&gt;ExecutorAdded&lt;/li&gt;
&lt;li&gt;ExecutorLost&lt;/li&gt;
&lt;li&gt;BeginEvent&lt;/li&gt;
&lt;li&gt;GettingResultEvent&lt;/li&gt;
&lt;li&gt;CompletionEvent&lt;/li&gt;
&lt;li&gt;ResubmitFailedStages&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä»¥&lt;code&gt;JobSubmitted&lt;/code&gt;äº‹ä»¶ä¸ºä¾‹ï¼š&lt;/p&gt;
&lt;div class="source" style="font-family: Monaco, Consolas, 'Lucida Console', 'Courier New'; color: rgb(220, 220, 204); background-color: rgb(63, 63, 63);"&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;1&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;case&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;JobSubmitted&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;jobId&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;rdd&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;func&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;partitions&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;allowLocal&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;callSite&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;listener&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;properties&lt;/span&gt;) &lt;span style="color: rgb(227, 206, 171);"&gt;=&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;2&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(204, 120, 51);"&gt;dagScheduler&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;handleJobSubmitted&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;jobId&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;rdd&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;func&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;partitions&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;allowLocal&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;callSite&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;3&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;listener&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;properties&lt;/span&gt;)&lt;br&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;p&gt;&lt;code&gt;dagScheduler.handleJobSubmitted&lt;/code&gt;å°†æ¥æ”¶åˆ°finalRDDçš„ä¾èµ–å…³ç³»è§£æå‡ºæ¥ï¼Œç”Ÿæˆstagesï¼Œå³æ•´ä¸ªDAGçš„ç»“æ„ï¼Œå†è°ƒç”¨å‡½æ•°å°†stageå†…çš„tasksæ‰“åŒ…æˆTaskSet,äº¤ç»™taskSchedulerå¤„ç†ã€‚è·Ÿç€è¿™ä¸ªæ–¹æ³•ï¼Œ&lt;code&gt;handleJobSubmitted&lt;/code&gt;ï¼Œå°±å¯ä»¥äº†è§£DAGSchedulerçš„ä¸»è¦åŠŸèƒ½å’Œå®ç°åŸç†ã€‚&lt;/p&gt;
&lt;div class="source" style="font-family: Monaco, Consolas, 'Lucida Console', 'Courier New'; color: rgb(220, 220, 204); background-color: rgb(63, 63, 63);"&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;01&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;private&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;scheduler&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;]&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;def&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;handleJobSubmitted&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;jobId&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Int&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;02&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;finalRDD&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;RDD&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;_&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;],&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;03&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;func&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; (&lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;TaskContext&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Iterator&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;_&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;])&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&amp;gt;&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;_&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;04&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;partitions&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Array&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Int&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;],&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;05&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;allowLocal&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Boolean&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;06&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;callSite&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;CallSite&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;07&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;listener&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;JobListener&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;08&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;properties&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Properties&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;null&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;09&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;10&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;var&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;finalStage&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Stage&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;null&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;11&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;try&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;12&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(127, 159, 127);"&gt;// New stage creation may throw an exception if, for example, jobs are run on a&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;13&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(127, 159, 127);"&gt;// HadoopRDD whose underlying HDFS files have been deleted.&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;14&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;finalStage&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;newStage&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;finalRDD&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;partitions&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;size&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;None&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;jobId&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;callSite&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;15&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;catch&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;16&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;case&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;e&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Exception&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;=&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;17&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;logWarning&lt;/span&gt;(&lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;Creating new stage failed due to exception - job: &amp;quot;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;jobId&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;e&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;18&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;listener&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;jobFailed&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;e&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;19&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;return&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;20&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;21&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;if&lt;/span&gt; (&lt;span style="color: rgb(220, 220, 204);"&gt;finalStage&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;!=&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;null&lt;/span&gt;) &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;22&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;job&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;new&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;ActiveJob&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;jobId&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;finalStage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;func&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;partitions&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;callSite&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;listener&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;properties&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;23&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;clearCacheLocs&lt;/span&gt;()&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;24&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;logInfo&lt;/span&gt;(&lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;Got job %s (%s) with %d output partitions (allowLocal=%s)&amp;quot;&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;format&lt;/span&gt;(&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;25&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;job&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;jobId&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;callSite&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;shortForm&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;partitions&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;length&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;allowLocal&lt;/span&gt;))&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;26&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;logInfo&lt;/span&gt;(&lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;Final stage: &amp;quot;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;finalStage&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;(&amp;quot;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;finalStage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;name&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;)&amp;quot;&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;27&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;logInfo&lt;/span&gt;(&lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;Parents of final stage: &amp;quot;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;finalStage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;parents&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;28&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;logInfo&lt;/span&gt;(&lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;Missing parents: &amp;quot;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;getMissingParentStages&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;finalStage&lt;/span&gt;))&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;29&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;shouldRunLocally&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;30&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;localExecutionEnabled&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;allowLocal&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;finalStage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;parents&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;isEmpty&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;partitions&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;length&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;==&lt;/span&gt; &lt;span style="color: rgb(140, 208, 211);"&gt;1&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;31&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;if&lt;/span&gt; (&lt;span style="color: rgb(220, 220, 204);"&gt;shouldRunLocally&lt;/span&gt;) &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;32&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(127, 159, 127);"&gt;// Compute very short actions like first() or take() with no parent stages locally.&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;33&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;listenerBus&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;post&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;SparkListenerJobStart&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;job&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;jobId&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;Seq&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;empty&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;properties&lt;/span&gt;))&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;34&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;runLocally&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;job&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;35&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;else&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;36&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;jobIdToActiveJob&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;jobId&lt;/span&gt;) &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;job&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;37&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;activeJobs&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;job&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;38&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;finalStage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;resultOfJob&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;Some&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;job&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;39&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;stageIds&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;jobIdToStageIds&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;jobId&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;).&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;toArray&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;40&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;stageInfos&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;stageIds&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;flatMap&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;id&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&amp;gt;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;stageIdToStage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;get&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;id&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;).&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;map&lt;/span&gt;(&lt;span style="color: rgb(227, 206, 171);"&gt;_&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;latestInfo&lt;/span&gt;))&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;41&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;listenerBus&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;post&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;SparkListenerJobStart&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;job&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;jobId&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;stageInfos&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;properties&lt;/span&gt;))&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;42&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;submitStage&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;finalStage&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;43&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;44&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;45&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;submitWaitingStages&lt;/span&gt;()&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;46&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;p&gt;å¯ä»¥çœ‹å‡ºï¼ŒDAGSchedulerç”Ÿæˆstageï¼Œæ˜¯é€šè¿‡æœ€åä¸€ä¸ªRDDæ¨ç®—å‡ºæ¥çš„ï¼Œï¼ˆè¿™ä¸ªRDDé€šè¿‡&lt;code&gt;sc.runJob()&lt;/code&gt; -&amp;gt; &lt;code&gt;dagScheduler.runJob()&lt;/code&gt; -&amp;gt; &lt;code&gt;dagScheduler.submitJob()&lt;/code&gt; -&amp;gt; &lt;code&gt;JobSubmitted()&lt;/code&gt; -&amp;gt; &lt;code&gt;dagScheduler.handleJobSubmitted()&lt;/code&gt; å±‚å±‚è°ƒç”¨ä¼ è¿›æ¥çš„ï¼‰&lt;/p&gt;
&lt;p&gt;è¿™ä¸€è¡Œä»£ç ï¼Œ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;finalStage = newStage(finalRDD, partitions.size, None, jobId, callSite)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;é€šè¿‡è°ƒç”¨&lt;code&gt;newStage()&lt;/code&gt;æ–¹æ³•ï¼Œç”Ÿæˆäº†&lt;strong&gt;finalStage&lt;/strong&gt;ã€‚å®é™…ä¸Šï¼Œ&lt;code&gt;newStage()&lt;/code&gt;ä¸­è°ƒç”¨äº†&lt;code&gt;getParentStages()&lt;/code&gt;æ–¹æ³•ï¼Œç”±finalRDDå‘å‰è¿½æº¯ï¼Œç”Ÿæˆäº†parentStagesã€‚&lt;/p&gt;
&lt;div class="source" style="font-family: Monaco, Consolas, 'Lucida Console', 'Courier New'; color: rgb(220, 220, 204); background-color: rgb(63, 63, 63);"&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;01&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;private&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;def&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;getParentStages&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;rdd&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;RDD&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;_&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;],&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;jobId&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Int&lt;/span&gt;)&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;List&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;]&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;02&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;parents&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;new&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;HashSet&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;]&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;03&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;visited&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;new&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;HashSet&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;RDD&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;_&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;]]&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;04&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(127, 159, 127);"&gt;// We are manually maintaining a stack here to prevent StackOverflowError&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;05&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(127, 159, 127);"&gt;// caused by recursively visiting&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;06&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;waitingForVisit&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;new&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;Stack&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;RDD&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;_&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;]]&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;07&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;def&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;visit&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;r&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;RDD&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;_&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;])&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;08&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;if&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;(!&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;visited&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;r&lt;/span&gt;)) &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;09&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;visited&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;r&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;10&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(127, 159, 127);"&gt;// Kind of ugly: need to register RDDs with the cache here since&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;11&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(127, 159, 127);"&gt;// we can&amp;#39;t do it in its constructor because # of partitions is unknown&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;12&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;for&lt;/span&gt; (&lt;span style="color: rgb(220, 220, 204);"&gt;dep&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;&amp;lt;-&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;r&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;dependencies&lt;/span&gt;) &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;13&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;dep&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;match&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;14&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;case&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;shufDep&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;ShuffleDependency&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;_&lt;/span&gt;, &lt;span style="color: rgb(227, 206, 171);"&gt;_&lt;/span&gt;, &lt;span style="color: rgb(227, 206, 171);"&gt;_&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;]&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;15&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;parents&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;getShuffleMapStage&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;shufDep&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;jobId&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;16&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;case&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;_&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;17&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;waitingForVisit&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;push&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;dep&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;rdd&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;18&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;19&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;20&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;21&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;22&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;waitingForVisit&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;push&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;rdd&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;23&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;while&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;(!&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;waitingForVisit&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;isEmpty&lt;/span&gt;) &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;24&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;visit&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;waitingForVisit&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;pop&lt;/span&gt;())&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;25&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;26&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;parents&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;toList&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;27&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;p&gt;å›åˆ°&lt;code&gt;handleJobSubmitted()&lt;/code&gt;,çœ‹åˆ°27ã€28ä¸¤è¡Œï¼Œä¸€ä¸ªæ˜¯&lt;em&gt;"Parents of final stage: "&lt;/em&gt;ï¼Œè¿™ä¸ªæ˜¯ç”±&lt;strong&gt;getParentStagesï¼ˆï¼‰&lt;/strong&gt;æ–¹æ³•è·å–çš„ï¼Œè€Œ&lt;em&gt;"Missing parents: "&lt;/em&gt;ï¼Œæ˜¯ç”±&lt;strong&gt;getMissingParentStages&lt;/strong&gt;è·å–çš„ï¼Œåœ¨è¿™é‡Œ(handleJobSubmitted()),ä¸¤è€…æ²¡æœ‰ä»€ä¹ˆä¸åŒã€‚ä½†æ˜¯åœ¨å…¶ä»–åœ°æ–¹ï¼Œè°ƒç”¨ä¸¤ä¸ªå‡½æ•°è¿˜æ˜¯ä¼šæœ‰ä¸åŒæ•ˆæœã€‚&lt;/p&gt;
&lt;div class="source" style="font-family: Monaco, Consolas, 'Lucida Console', 'Courier New'; color: rgb(220, 220, 204); background-color: rgb(63, 63, 63);"&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;01 &lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;private&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;def&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;getMissingParentStages&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Stage&lt;/span&gt;)&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;List&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;]&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;02 &lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;missing&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;new&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;HashSet&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;]&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;03 &lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;visited&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;new&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;HashSet&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;RDD&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;_&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;]]&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;04 &lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(127, 159, 127);"&gt;// We are manually maintaining a stack here to prevent StackOverflowError&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;05 &lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(127, 159, 127);"&gt;// caused by recursively visiting&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;06 &lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;waitingForVisit&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;new&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;Stack&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;RDD&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;_&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;]]&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;07 &lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;def&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;visit&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;rdd&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;RDD&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;_&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;])&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;08 &lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;if&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;(!&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;visited&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;rdd&lt;/span&gt;)) &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;09 &lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;visited&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;rdd&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;10 &lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;if&lt;/span&gt; (&lt;span style="color: rgb(220, 220, 204);"&gt;getCacheLocs&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;rdd&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;).&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;contains&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;Nil&lt;/span&gt;)) &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;11 &lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;for&lt;/span&gt; (&lt;span style="color: rgb(220, 220, 204);"&gt;dep&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;&amp;lt;-&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;rdd&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;dependencies&lt;/span&gt;) &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;12 &lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;dep&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;match&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;13 &lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;case&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;shufDep&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;ShuffleDependency&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;_&lt;/span&gt;, &lt;span style="color: rgb(227, 206, 171);"&gt;_&lt;/span&gt;, &lt;span style="color: rgb(227, 206, 171);"&gt;_&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;]&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;14 &lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;mapStage&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;getShuffleMapStage&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;shufDep&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;jobId&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;15 &lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;if&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;(!&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;mapStage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;isAvailable&lt;/span&gt;) &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;16 &lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;missing&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;mapStage&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;17 &lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;18 &lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;case&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;narrowDep&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;NarrowDependency&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;_&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;]&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;19 &lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;waitingForVisit&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;push&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;narrowDep&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;rdd&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;20 &lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;21 &lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;22 &lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;23 &lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;24 &lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;25 &lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;waitingForVisit&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;push&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;rdd&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;26 &lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;while&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;(!&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;waitingForVisit&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;isEmpty&lt;/span&gt;) &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;27 &lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;visit&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;waitingForVisit&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;pop&lt;/span&gt;())&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;28 &lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;29 &lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;missing&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;toList&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;30 &lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;p&gt;ç”±ä»¥ä¸Šçš„ä»£ç å¯ä»¥çœ‹å‡ºï¼Œ&lt;code&gt;getMissingParentStages()&lt;/code&gt;ä¸&lt;code&gt;getParentStages()&lt;/code&gt;åœ¨ç¬¬15ã€16è¡Œã€‚&lt;/p&gt;
&lt;p&gt;å›åˆ°&lt;code&gt;handleJobSubmitted()&lt;/code&gt;41ã€42è¡Œï¼ŒDAGSchedulerå‘ç›‘å¬æ€»çº¿å‘ç”Ÿä¸€ä¸ªJobStartçš„äº‹ä»¶ï¼Œä¹‹åï¼Œè°ƒç”¨&lt;code&gt;submitStage()&lt;/code&gt;å°†ç”Ÿæˆçš„Stageæäº¤&lt;/p&gt;
&lt;div class="source" style="font-family: Monaco, Consolas, 'Lucida Console', 'Courier New'; color: rgb(220, 220, 204); background-color: rgb(63, 63, 63);"&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;01&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;/** Submits stage, but first recursively submits any missing parents. */&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;02&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;private&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;def&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;submitStage&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Stage&lt;/span&gt;) &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;03&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;jobId&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;activeJobForStage&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;04&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;if&lt;/span&gt; (&lt;span style="color: rgb(220, 220, 204);"&gt;jobId&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;isDefined&lt;/span&gt;) &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;05&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;logDebug&lt;/span&gt;(&lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;submitStage(&amp;quot;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;)&amp;quot;&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;06&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;if&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;(!&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;waitingStages&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;) &lt;span style="color: rgb(220, 220, 204);"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;!&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;runningStages&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;) &lt;span style="color: rgb(220, 220, 204);"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;!&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;failedStages&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;)) &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;07&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;missing&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;getMissingParentStages&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;).&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;sortBy&lt;/span&gt;(&lt;span style="color: rgb(227, 206, 171);"&gt;_&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;id&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;08&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;logDebug&lt;/span&gt;(&lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;missing: &amp;quot;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;missing&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;09&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;if&lt;/span&gt; (&lt;span style="color: rgb(220, 220, 204);"&gt;missing&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;==&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;Nil&lt;/span&gt;) &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;10&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;logInfo&lt;/span&gt;(&lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;Submitting &amp;quot;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot; (&amp;quot;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;rdd&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;), which has no missing parents&amp;quot;&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;11&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(204, 120, 51);"&gt;submitMissingTasks&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;jobId&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;get&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;12&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;else&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;13&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;for&lt;/span&gt; (&lt;span style="color: rgb(220, 220, 204);"&gt;parent&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;&amp;lt;-&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;missing&lt;/span&gt;) &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;14&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;submitStage&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;parent&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;15&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;16&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;waitingStages&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;17&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;18&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;19&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;else&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;20&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;abortStage&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;No active job for stage &amp;quot;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;id&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;21&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;22&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;p&gt;åœ¨&lt;code&gt;submitMissingTasks()&lt;/code&gt;ä¸­ï¼ŒDAGSchedulerå°†stageä¸­çš„tasksè¿›è¡Œæ‹†åˆ†ï¼Œå¹¶å°†tasksæ‰“åŒ…æˆTaskSetï¼Œäº¤ç»™TaskSchedulerå¤„ç†ã€‚
&lt;div class="source" style="font-family: Monaco, Consolas, 'Lucida Console', 'Courier New'; color: rgb(220, 220, 204); background-color: rgb(63, 63, 63);"&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;01&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;/*&lt;em&gt; Called when stage&amp;#39;s parents are available and we can now do its task. &lt;/em&gt;/&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;02&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;private&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;def&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;submitMissingTasks&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;jobId&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Int&lt;/span&gt;) &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;03&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;logDebug&lt;/span&gt;(&lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;submitMissingTasks(&amp;quot;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;)&amp;quot;&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;04&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(127, 159, 127);"&gt;// Get our pending tasks and remember them in our pendingTasks entry&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;05&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;pendingTasks&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;clear&lt;/span&gt;()&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;06&amp;nbsp;&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;07&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;Â·Â·Â·Â·&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;08&amp;nbsp;&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;09&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; &lt;span style="color: rgb(204, 120, 51);"&gt;tasks&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Seq&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Task&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;[&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;_&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;]]&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;if&lt;/span&gt; (&lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;isShuffleMap&lt;/span&gt;) &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;10&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;partitionsToCompute&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;map&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;id&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;11&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;locs&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;getPreferredLocs&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;rdd&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;id&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;12&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;part&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;rdd&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;partitions&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;id&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;13&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;new&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;ShuffleMapTask&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;id&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;taskBinary&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;part&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;locs&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;14&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;15&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;else&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;16&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;job&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;resultOfJob&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;get&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;17&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;partitionsToCompute&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;map&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;id&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;18&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; p&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;Int&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;job&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;partitions&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;id&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;19&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;part&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;rdd&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;partitions&lt;/span&gt;(p)&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;20&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;val&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;locs&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;getPreferredLocs&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;rdd&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; p)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;21&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;new&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;ResultTask&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;id&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;taskBinary&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;part&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;locs&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;id&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;22&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;23&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;24&amp;nbsp;&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;25&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;if&lt;/span&gt; (&lt;span style="color: rgb(220, 220, 204);"&gt;tasks&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;size&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;&amp;gt;&lt;/span&gt; &lt;span style="color: rgb(140, 208, 211);"&gt;0&lt;/span&gt;) &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;26&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(127, 159, 127);"&gt;// Preemptively serialize a task to make sure it can be serialized. &lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;27&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;try&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;28&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;closureSerializer&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;serialize&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;tasks&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;head&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;29&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;catch&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;30&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;case&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;e&lt;/span&gt;&lt;span style="color: rgb(227, 206, 171);"&gt;:&lt;/span&gt; &lt;span style="color: rgb(223, 223, 191); font-weight: bold;"&gt;NotSerializableException&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;=&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;31&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;abortStage&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;Task not serializable: &amp;quot;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;e&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;toString&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;32&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;runningStages&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;-=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;33&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;return&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;34&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;case&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;NonFatal&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;e&lt;/span&gt;) &lt;span style="color: rgb(227, 206, 171);"&gt;=&amp;gt;&lt;/span&gt; &lt;span style="color: rgb(127, 159, 127);"&gt;// Other exceptions, such as IllegalArgumentException from Kryo.&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;35&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;abortStage&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; s&lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;Task serialization failed: $e\n${e.getStackTraceString}&amp;quot;&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;36&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;runningStages&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;-=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;37&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;return&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;38&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;39&amp;nbsp;&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;40&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;logInfo&lt;/span&gt;(&lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;Submitting &amp;quot;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;tasks&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;size&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot; missing tasks from &amp;quot;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot; (&amp;quot;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;rdd&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;)&amp;quot;&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;41&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;pendingTasks&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;++=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;tasks&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;42&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;logDebug&lt;/span&gt;(&lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;New pending tasks: &amp;quot;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;pendingTasks&lt;/span&gt;)&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;43&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(204, 120, 51);"&gt;taskScheduler&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;submitTasks&lt;/span&gt;(&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;44&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(227, 206, 171);"&gt;new&lt;/span&gt; &lt;span style="color: rgb(204, 120, 51);"&gt;TaskSet&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;tasks&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;toArray&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;id&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;newAttemptId&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;(),&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;jobId&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;properties&lt;/span&gt;))&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;45&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;latestInfo&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;submissionTime&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;Some&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;clock&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;getTime&lt;/span&gt;())&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;46&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt; &lt;span style="color: rgb(227, 206, 171);"&gt;else&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;47&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(127, 159, 127);"&gt;// Because we posted SparkListenerStageSubmitted earlier, we should post&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;48&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(127, 159, 127);"&gt;// SparkListenerStageCompleted here in case there are no tasks to run.&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;49&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;listenerBus&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;post&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;SparkListenerStageCompleted&lt;/span&gt;(&lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;latestInfo&lt;/span&gt;))&lt;br&gt;&lt;span style="color: rgb(248, 16, 176);"&gt;50&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;logDebug&lt;/span&gt;(&lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot;Stage &amp;quot;&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;+&lt;/span&gt; &lt;span style="color: rgb(204, 147, 147);"&gt;&amp;quot; is actually done; %b %d %d&amp;quot;&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;format&lt;/span&gt;(&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;51&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;isAvailable&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;numAvailableOutputs&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;,&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;.&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;numPartitions&lt;/span&gt;))&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;52&amp;nbsp;&lt;/span&gt; &amp;nbsp; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;runningStages&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;-=&lt;/span&gt; &lt;span style="color: rgb(220, 220, 204);"&gt;stage&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;53&amp;nbsp;&lt;/span&gt; &amp;nbsp;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="color: rgb(127, 159, 127);"&gt;54&amp;nbsp;&lt;/span&gt;&lt;span style="color: rgb(220, 220, 204);"&gt;}&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;æ¥ä¸‹æ¥çš„å·¥ä½œï¼Œå°±äº¤ç»™TaskSchedulerè§£å†³äº†ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰æ—¶é—´å†æ•´ç†ä¸€ä¸‹å§&lt;/p&gt;</summary><category term="spark"></category><category term="source code"></category><category term=""></category></entry><entry><title>Ganliaé‡‡æ ·ã€ç»Ÿè®¡åŠRRDè®°å½•å‘¨æœŸï¼ˆé¢‘æ¬¡ã€é—´éš”ï¼‰çš„é…ç½®å’Œæ›´æ”¹</title><link href="http://www.guozhongxin.com/pages/2014/10/15/ganglia_frequency.html" rel="alternate"></link><updated>2014-10-15T22:00:00+08:00</updated><author><name>guozhongxin</name></author><id>tag:www.guozhongxin.com,2014-10-15:pages/2014/10/15/ganglia_frequency.html</id><summary type="html">&lt;h2&gt;Ganglia &amp;amp; RRD&lt;/h2&gt;
&lt;p&gt;Gangliaæ˜¯ä¼¯å…‹åˆ©å¼€å‘çš„ä¸€ä¸ªé›†ç¾¤ç›‘æ§è½¯ä»¶ã€‚å¯ä»¥ç›‘è§†å’Œæ˜¾ç¤ºé›†ç¾¤ä¸­çš„èŠ‚ç‚¹çš„å„ç§çŠ¶æ€ä¿¡æ¯ï¼Œæ¯”å¦‚å¦‚ï¼šcpu ã€memã€ç¡¬ç›˜åˆ©ç”¨ç‡ï¼Œ I/Oè´Ÿè½½ã€ç½‘ç»œæµé‡æƒ…å†µç­‰ï¼ŒåŒæ—¶å¯ä»¥å°†å†å²æ•°æ®ä»¥æ›²çº¿æ–¹å¼é€šè¿‡phpé¡µé¢å‘ˆç°ã€‚&lt;/p&gt;
&lt;p&gt;Gangliaç›‘æ§ç³»ç»Ÿçš„æ ¸å¿ƒæœ‰ä¸¤éƒ¨åˆ†ï¼šgmond å’Œ gmetadï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;gmondåœ¨å„ä¸ªèŠ‚ç‚¹ä¸Šè¿è¡Œï¼Œè´Ÿè´£é‡‡é›†æ•°æ®ï¼›&lt;/li&gt;
&lt;li&gt;gmetadåœ¨ä¸»èŠ‚ç‚¹ä¸Šè¿è¡Œï¼Œè´Ÿè´£æ¥æ”¶gmondé‡‡é›†ä¸Šæ¥çš„æ•°æ®å¹¶å°†ä¹‹å‚¨å­˜åœ¨RRDä¸­ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;RRDï¼ˆRound-Robin Databaseï¼‰æ˜¯ä¸€ç§å›ºå®šå¤§å°çš„ç¯å½¢çš„æ•°æ®åº“ï¼Œä¸€ä¸ªRRDæ–‡ä»¶ä¸‹å¯ä»¥æœ‰å¤šä¸ªRRAï¼Œæ¯ä¸ªRRAæ˜¯ä¸€ä¸ªç¯ï¼Œç¯ä¸Šå¯ä»¥å‚¨å­˜çš„æ•°æ®ä¸ªæ•°æ˜¯å›ºå®šä¸ªï¼Œæ–°çš„æ•°æ®è¢«è®°å½•æ—¶ä¼šè¦†ç›–æœ€æ—§çš„é‚£æ¡æ•°æ®ï¼Œä»è€Œå‘¨è€Œå¤å§‹çš„è®°å½•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="1" src="http://www.guozhongxin.com/images/RRD.jpg" /&gt; &lt;/p&gt;
&lt;p&gt;Gangliaå°†ç›‘æ§æ•°æ®ä»¥RRDçš„å½¢å¼å‚¨å­˜å¹¶é€šè¿‡phpå±•ç¤ºåœ¨webé¡µé¢ä¸Šã€‚Gangliaé»˜è®¤çš„æ˜¯15ç§’åœ¨RRDä¸­è®°å½•ä¸€æ¬¡æ•°æ®ï¼Œè€ŒRRDé»˜è®¤çš„æ ¼å¼ä¸ºï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;RRAs &amp;quot;RRA:AVERAGE:0.5:1:244&amp;quot; &amp;quot;RRA:AVERAGE:0.5:24:244&amp;quot; &amp;quot;RRA:AVERAGE:0.5:168:244&amp;quot; &amp;quot;RRA:AVERAGE:0.5:672:244&amp;quot; &amp;quot;RRA:AVERAGE:0.5:5760:374&amp;quot;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™æ˜¯Gangliaåˆ›å»ºçš„RRDçš„é»˜è®¤å½¢å¼ï¼Œä¸€ä¸ªRRDæ–‡ä»¶æœ‰å››ä¸ªRRAç”¨æ¥è®°å½•æ•°æ®ã€‚  &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ç¬¬ä¸€ä¸ªRRAä¸€å…±å‚¨å­˜ç€244ä¸ªæ•°æ®ï¼Œæ¯æ’å…¥ä¸€æ¡æ•°æ®å‚¨å­˜ä¸€ä¸ªæ•°æ®ï¼ŒGangliaé»˜è®¤çš„15sè®°å½•ä¸€æ¬¡ï¼Œè¿™å°±æ„å‘³ç€é»˜è®¤çš„è¿™ä¸ªRRAè®°å½•ç€æœ€è¿‘61åˆ†é’Ÿçš„æ•°æ®ï¼Œè¿™ä¹Ÿå°±æ˜¯åœ¨webä¸Šçœ‹åˆ°çš„ä¸€å°æ—¶çš„å›¾ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¬¬äºŒä¸ªRRAä¸€å…±å‚¨å­˜ç€244ä¸ªæ•°æ®ï¼Œæ¯æ’å…¥24æ¡æ•°æ®å–å¹³å‡æ•°ï¼Œå‚¨å­˜ä¸€ä¸ªæ•°æ®ï¼Œ15s * 24 = 360sï¼Œæ„å‘³ç€6åˆ†é’Ÿå‚¨å­˜ä¸€æ¡æ•°æ®ã€‚æ€»å…±è®°å½•äº† 6min * 244 = 1464min = 24.4h çº¦ä¸ºä¸€å¤©çš„æ•°æ®ã€‚å¯¹åº”çš„æ˜¯webä¸Šæœ€è¿‘24hçš„æ•°æ®å›¾ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¬¬ä¸‰ä¸ªRRAï¼Œæ¯æ’å…¥168æ¡æ•°æ®å–å¹³å‡æ•°å‚¨å­˜ä¸€æ¡æ•°æ®ï¼Œ15s * 168 = 42minï¼Œ42åˆ†é’Ÿè®°å½•ä¸€æ¡æ•°æ®ï¼Œæ€»å…±è®°å½• 42min * 244 = 7.1d çº¦ä¸ºä¸€å‘¨çš„æ•°æ®ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¬¬å››ä¸ªRRAï¼Œè®°å½•æœ€è¿‘å››å‘¨çš„æ•°æ®ã€‚å¯¹åº”webç•Œé¢ä¸ŠLast monthçš„æ•°æ®ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;ç¬¬äº”ä¸ªRRAè®°å½•æœ€è¿‘ä¸€å¹´çš„æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;ä¸ºä»€ä¹ˆè¦æ›´æ”¹Ganliaé‡‡æ ·ã€ç»Ÿè®¡åŠRRDè®°å½•çš„æœ€å°é—´éš”&lt;/h2&gt;
&lt;p&gt;å¯¹äºç®€å•çš„é›†ç¾¤ç›‘æ§ï¼ŒGangliaçš„é»˜è®¤é…ç½®æ˜¯è¶³å¤Ÿçš„ï¼Œèƒ½å¤Ÿæ»¡è¶³é›†ç¾¤ç®¡ç†å‘˜å‘ç°é›†ç¾¤çš„æ€§èƒ½è¡¨ç°å’Œä¸€äº›æ•…éšœï¼Œå¹¶åˆ¤æ–­æ•…éšœå‘ç”Ÿåœ¨å“ªé‡Œã€‚  &lt;/p&gt;
&lt;p&gt;ä½†æ˜¯åœ¨è¿›è¡Œç»†è‡´çš„ä½œä¸šåˆ†ææ—¶ï¼Œ15sçš„æœ€å°é‡‡æ ·é—´éš”æ˜¯ä¸èƒ½å¤Ÿæ»¡è¶³éœ€æ±‚çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ç¬”è€…ç ”ç©¶çš„sparkä½œä¸šçš„æ€§èƒ½è¡¨ç°ä¸ºä¾‹ï¼Œå¯¹äº40Gçš„æ•°æ®ï¼Œåœ¨4èŠ‚ç‚¹ã€16GB per nodeã€32 cores per nodeçš„Sparké›†ç¾¤ä¸Šè¿›è¡Œwordcountï¼Œä½œä¸šçš„æ€»å…±è¿è¡Œæ—¶é—´å¹³å‡ä¸º53sï¼Œè€Œmap stageä¸­æ¯ä¸ªtaskçš„è¿è¡Œæ—¶é—´åœ¨10så·¦å³ï¼Œreduce&amp;amp;save stageä¸­æ¯ä¸ªtaskçš„è¿è¡Œæ—¶é—´ä¸è¿‡2-4sã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºsparké«˜æ•ˆçš„æ‰§è¡Œæ•ˆç‡ï¼Œsparkè¿è¡Œè¿‡ç¨‹ä¸­å ç”¨é›†ç¾¤èµ„æºçš„è¡Œä¸ºå˜åŒ–æ˜¯è¿…é€Ÿçš„ï¼Œ15sçš„è®°å½•é—´éš”æ˜¯æ— æ³•å¯Ÿè§‰çš„ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œ&lt;strong&gt;ä¸ºäº†è®©Gangliaèƒ½å¤Ÿæ›´å¥½çš„é€‚åº”Sparkçš„èŠ‚å¥ï¼Œéœ€è¦å°†Ganliaé‡‡æ ·ã€ç»Ÿè®¡åŠRRDè®°å½•çš„æœ€å°é—´éš”ç”±15sæ”¹åˆ°æ›´å°&lt;/strong&gt;ï¼Œç¬”è€…ç›´æ¥é€‰æ‹©åœ¨&lt;strong&gt;1s&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h2&gt;æ›´æ”¹Gangliaé…ç½®å‚æ•°ï¼Œä»¥æ›´æ”¹é‡‡æ ·å’Œè®°å½•çš„æœ€å°é—´éš”&lt;/h2&gt;
&lt;h3&gt;åœæ­¢Gangliaçš„è¿è¡Œ&lt;/h3&gt;
&lt;p&gt;ä¸ºäº†é¿å…å‡ºç°è¿è¡Œé”™è¯¯ï¼Œåœ¨æ›´æ”¹é…ç½®å‰å…³é—­gangliaçš„è¿è¡Œã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä¸»èŠ‚ç‚¹ä¸Šï¼Œä½¿ç”¨å‘½ä»¤ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;service gmetad stop
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨å„ä¸ªèŠ‚ç‚¹ä¸Šï¼Œä½¿ç”¨å‘½ä»¤ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;service gmond stop
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;æ›´æ”¹gmondé…ç½®ï¼ˆæ›´æ”¹æœé›†æ•°æ®çš„å‘¨æœŸï¼Œä»¥åŠä¼ è¾“ä¼ è¾“å‘¨æœŸï¼‰&lt;/h3&gt;
&lt;p&gt;gmondçš„é…ç½®åœ¨/etc/ganglia/gmond.confä¸­&lt;/p&gt;
&lt;p&gt;å¯¹äºåªå–ä¸€æ¬¡å€¼çš„metricï¼Œå°†&lt;code&gt;time_threshold&lt;/code&gt;ï¼Œå› ä¸ºè¿™äº›å€¼ï¼Œå¦‚&lt;code&gt;mem_total&lt;/code&gt;ï¼Œä¼šåœ¨webç«¯phpç”»å›¾æ—¶ç”¨åˆ°ï¼Œå› ä¸ºmemoryé‚£å¼ å›¾ä¸­çš„&lt;code&gt;memory used&lt;/code&gt;ï¼Œå¹¶ä¸æ˜¯é€šè¿‡ç›´æ¥é‡‡é›†æ•°æ®å¾—åˆ°çš„ï¼Œè€Œæ˜¯é€šè¿‡&lt;code&gt;mem_total&lt;/code&gt;å‡å»å…¶ä»–å€¼è®¡ç®—å¾—åˆ°çš„ï¼Œå› æ­¤ï¼Œ&lt;code&gt;mem_total&lt;/code&gt;ä¸€å¼€å§‹å°±åº”è¯¥è¢«è·å–ï¼Œå› æ­¤&lt;code&gt;time_threshold&lt;/code&gt;éœ€è®¾ä¸º1ï¼ˆé»˜è®¤ä¸º1200ï¼‰ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;collection_group {
  collect_once = yes
  time_threshold = 1
  metric {
    name = &amp;quot;cpu_num&amp;quot;
    title = &amp;quot;CPU Count&amp;quot;
  }
  ...
  metric {
    name = &amp;quot;mem_total&amp;quot;
    title = &amp;quot;Memory Total&amp;quot;
  }
  ...
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¯¹äºå…¶ä»–metricï¼Œå¦‚cpu groupä¸­çš„å„ä¸ªmetricï¼Œé‡‡æ ·ä¸ä¼ è¾“çš„æ—¶é—´ä¹Ÿåº”è®¾ç½®ä¸º1ï¼ˆsï¼‰&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;collection_group {
  collect_every = 20
  time_threshold = 90
  /* CPU status */
  metric {
    name = &amp;quot;cpu_user&amp;quot;
    value_threshold = &amp;quot;1.0&amp;quot;
    title = &amp;quot;CPU User&amp;quot;
  }
  metric {
    name = &amp;quot;cpu_system&amp;quot;
    value_threshold = &amp;quot;1.0&amp;quot;
    title = &amp;quot;CPU System&amp;quot;
  }
  ...
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å³&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;collect_every = 1
time_threshold = 1
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;æ›´æ”¹gmetadé…ç½®ï¼ˆæ›´æ”¹è®°å½•çš„æœ€å°é—´éš”ï¼‰&lt;/h3&gt;
&lt;p&gt;gmetadçš„é…ç½®åœ¨/etc/ganglia/gmetad.confä¸­&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;# Format: &lt;/span&gt;
&lt;span class="cp"&gt;# data_source &amp;quot;my cluster&amp;quot; [polling interval] address1:port addreses2:port ...&lt;/span&gt;
&lt;span class="cp"&gt;# The keyword &amp;#39;data_source&amp;#39; must immediately be followed by a unique&lt;/span&gt;
&lt;span class="cp"&gt;# string which identifies the source, then an optional polling interval in &lt;/span&gt;
&lt;span class="cp"&gt;# seconds. The source will be polled at this interval on average. &lt;/span&gt;
&lt;span class="cp"&gt;# If the polling interval is omitted, 15sec is asssumed.&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;çœ‹åˆ°è¿™é‡Œæœ‰å…³äº&lt;code&gt;[polling interval]&lt;/code&gt;çš„è§£é‡Šï¼Œå³gmetadä¼šæ ¹æ®ä»gmondæœé›†çš„æ•°æ®ï¼Œæ¯ä¸€ä¸ªé—´éš”è®¡ç®—å‡ºè¿™ä¸ªé—´éš”å†…çš„å¹³å‡æ•°å°†å…¶å†™å…¥rrdã€‚&lt;br /&gt;
è€Œè¿™ä¸ªå‚æ•°ï¼Œæ˜¯ä¸€ä¸ªéå¿…è¦çš„å‚æ•°ï¼Œå¦‚æœç”¨æˆ·ä¸æŒ‡å®šçš„è¯ï¼Œæ¯15sè®°å½•ä¸€æ¬¡ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œä¸ºäº†å°†Gangliaè®°å½•æœ€å°é—´éš”åŠRRDä¸­æ•°æ®çš„æœ€å°æ—¶é—´é—´éš”æ”¹ä¸º1sï¼Œéœ€è¦åœ¨masteråç§°åæ·»åŠ ä¸€ä¸ªå‚æ•°ï¼š1&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;data_source &amp;quot;my cluster&amp;quot; 1 localhost  my.machine.edu:8649 ...
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸ºäº†è®©webä¾ç„¶èƒ½å¤Ÿé¡ºåˆ©çš„ç”»å‡ºä¸€å¤©ã€ä¸€å‘¨ã€ä¸€æœˆã€ä¸€å¹´çš„å›¾ï¼Œè¿˜åº”è¯¥ä¿®æ”¹RRDçš„æ ¼å¼ã€‚&lt;/p&gt;
&lt;p&gt;åŸæ¥çš„é‡‡æ ·é—´éš”æ˜¯15sï¼Œç°åœ¨çš„é‡‡æ ·é—´éš”æ˜¯1sï¼Œå°±è¦æŠŠæ¯ä¸ªRRAçš„å®¹é‡æ‰©å……ï¼Œæˆ–è€…å°†é™¤äº†ç¬¬ä¸€ä¸ªRRAä¹‹å¤–çš„RRAçš„è®°å½•é—´éš”æ”¹å¤§ã€‚&lt;/p&gt;
&lt;p&gt;ä¸¤ç§è°ƒæ•´RRDæ ¼å¼çš„æ–¹æ³•ï¼š&lt;/p&gt;
&lt;p&gt;1.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;RRAs &amp;quot;RRA:AVERAGE:0.5:1:3660&amp;quot; &amp;quot;RRA:AVERAGE:0.5:24:3660&amp;quot; &amp;quot;RRA:AVERAGE:0.5:168:3660&amp;quot; &amp;quot;RRA:AVERAGE:0.5:672:3660&amp;quot;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;2.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;RRAs &amp;quot;RRA:AVERAGE:0.5:1:3660&amp;quot; &amp;quot;RRA:AVERAGE:0.5:360:244&amp;quot; &amp;quot;RRA:AVERAGE:0.5:2520:244&amp;quot; &amp;quot;RRA:AVERAGE:0.5:10080:244&amp;quot;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å› ä¸ºæˆ‘åªéœ€è¦è¿‘ä¸€å°æ—¶çš„è¯¦ç»†æ•°æ®ï¼Œå› æ­¤ï¼Œæˆ‘é‡‡ç”¨ç¬¬äºŒç§æ–¹å¼ï¼ŒRRDçš„æ–‡ä»¶ä¼šå°ä¸€äº›ã€‚&lt;/p&gt;
&lt;h3&gt;æ¸…é™¤åŸæœ‰RRD&lt;/h3&gt;
&lt;p&gt;å› ä¸ºRRDçš„æ ¼å¼å‘ç”Ÿå˜åŒ–ï¼Œå’ŒåŸæœ‰çš„RRDä¸åŒï¼Œå› æ­¤ï¼Œéœ€è¦å°†åŸæ¥çš„RRDåˆ é™¤ï¼Œ&lt;/p&gt;
&lt;p&gt;RRDçš„æ–‡ä»¶å‚¨å­˜ä½ç½®çš„é…ç½®åœ¨gmetad.confä¸­ï¼š&lt;code&gt;rrd_rootdir&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;rrd_rootdir&lt;/code&gt;çš„é»˜è®¤ä½ç½®åœ¨&lt;code&gt;/var/lib/ganglia/rrds&lt;/code&gt;ï¼Œå°†è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åŠæ–‡ä»¶å¤¹åˆ é™¤å³å¯ã€‚&lt;/p&gt;
&lt;h3&gt;å¯åŠ¨Ganglia&lt;/h3&gt;
&lt;p&gt;åœ¨ä¸»èŠ‚ç‚¹ä¸Šï¼Œä½¿ç”¨å‘½ä»¤ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;service gmetad start
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨å„ä¸ªèŠ‚ç‚¹ä¸Šï¼Œä½¿ç”¨å‘½ä»¤ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;service gmond start
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;æŸ¥çœ‹æ›´æ”¹ä¹‹åçš„æ•ˆæœ&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;service httpd restart
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨http://masterhost/gangliaä¸­å¯ä»¥çœ‹åˆ°æ›´æ”¹ä¹‹åçš„å˜åŒ–ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="image" src="http://www.guozhongxin.com/images/ganglia_old.png" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="image" src="http://www.guozhongxin.com/images/ganglia_new.png" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="image" src="http://www.guozhongxin.com/images/ganglia_big.png" /&gt;&lt;/p&gt;
&lt;p&gt;æœ€åä¸€å¼ å›¾æ˜æ˜¾èƒ½çœ‹å‡ºæ›´æ”¹ä¹‹åç»Ÿè®¡çš„æ•°æ®æ›´ç»†è…»ã€‚&lt;/p&gt;</summary><category term="ganglia"></category><category term=""></category></entry><entry><title>Windows + IDEA + SBT æ‰“é€ Sparkæºç é˜…è¯»ç¯å¢ƒ</title><link href="http://www.guozhongxin.com/pages/2014/10/15/spark_source_code.html" rel="alternate"></link><updated>2014-10-15T11:00:00+08:00</updated><author><name>guozhongxin</name></author><id>tag:www.guozhongxin.com,2014-10-15:pages/2014/10/15/spark_source_code.html</id><summary type="html">&lt;h2&gt;Sparkæºç é˜…è¯»ç¯å¢ƒçš„å‡†å¤‡&lt;/h2&gt;
&lt;p&gt;Sparkæºç æ˜¯æœ‰Scalaè¯­è¨€å†™æˆçš„ï¼Œç›®å‰ï¼Œ&lt;a href="/http://www.jetbrains.com/idea/"&gt;IDEA&lt;/a&gt;å¯¹Scalaçš„æ”¯æŒè¦æ¯”eclipseè¦å¥½ï¼Œå¤§å¤šæ•°äººä¼šé€‰åœ¨åœ¨IDEAä¸Šå®ŒæˆSparkå¹³å°åº”ç”¨çš„å¼€å‘ã€‚å› æ­¤ï¼ŒSparkæºç é˜…è¯»çš„IDEç†æ‰€å½“ç„¶çš„é€‰æ‹©äº†IDEAã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ä»‹ç»çš„æ˜¯Windowsä¸‹çš„å„é¡¹é…ç½®æ–¹æ³•ï¼ˆé»˜è®¤å·²ç»è£…äº†javaï¼ŒJDKï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢åˆ—ä¸¾æ­å»ºæ­¤ç¯å¢ƒéœ€è¦çš„å„ä¸ªç»„ä»¶ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://www.jetbrains.com/idea/download/"&gt;&lt;strong&gt;IDEA&lt;/strong&gt;&lt;/a&gt;ï¼Œæœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼šUltimate Edition &amp;amp; Community Editionï¼Œåè€…æ˜¯freeçš„ï¼Œè€Œä¸”å®Œå…¨èƒ½æ»¡è¶³å­¦ä¹ è€…æ‰€æœ‰çš„éœ€æ±‚  &lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.scala-lang.org/download/"&gt;&lt;strong&gt;Scala&lt;/strong&gt;&lt;/a&gt;ï¼ŒSparkæ˜¯ç”¨Scalaè¯­è¨€å†™æˆçš„ï¼Œåœ¨æœ¬åœ°ç¼–è¯‘æ‰§è¡Œéœ€è¦è¿™ä¸ªåŒ…&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.scala-sbt.org/download.html"&gt;&lt;strong&gt;SBT&lt;/strong&gt;&lt;/a&gt;ï¼Œscalaå·¥ç¨‹æ„å»ºçš„å·¥å…·&lt;/li&gt;
&lt;li&gt;&lt;a href="http://git-scm.com/download/"&gt;&lt;strong&gt;Git&lt;/strong&gt;&lt;/a&gt;ï¼ŒIDEAè‡ªåŠ¨ä¸‹è½½SBTæ’ä»¶æ—¶å¯èƒ½ä¼šç”¨åˆ°çš„å·¥å…·&lt;/li&gt;
&lt;li&gt;&lt;a href="http://spark.apache.org/downloads.html"&gt;&lt;strong&gt;Spark Source Code&lt;/strong&gt;&lt;/a&gt;ï¼ŒSparkæºç &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸‹è½½å„ä¸ªå®‰è£…åŒ…ã€‚&lt;/p&gt;
&lt;h2&gt;Sparkæºç é˜…è¯»ç¯å¢ƒçš„å®‰è£…æ­¥éª¤&lt;/h2&gt;
&lt;h4&gt;å®‰è£…&lt;a href="http://www.scala-lang.org/download/"&gt;Scala&lt;/a&gt;ã€‚&lt;/h4&gt;
&lt;p&gt;å®Œæˆåï¼Œåœ¨windowså‘½ä»¤è¡Œä¸­è¾“å…¥&lt;code&gt;scala&lt;/code&gt;ï¼Œæ£€æŸ¥æ˜¯å¦è¯†åˆ«æ­¤å‘½ä»¤ã€‚&lt;br /&gt;
å¦‚æœä¸è¯†åˆ«ï¼ŒæŸ¥çœ‹ç¯å¢ƒå˜é‡Pathä¸­æ˜¯å¦æœ‰&lt;code&gt;....\scala\bin&lt;/code&gt;ï¼ˆæˆ‘çš„ç”µè„‘å³é”®ï¼Œå±æ€§ -&amp;gt; é«˜çº§ç³»ç»Ÿè®¾ç½® -&amp;gt; ç¯å¢ƒå˜é‡ï¼‰,æ²¡æœ‰çš„æ‰‹åŠ¨å°†Scalaæ–‡ä»¶å¤¹ä¸‹çš„binç›®å½•çš„è·¯å¾„&lt;/p&gt;
&lt;h4&gt;å®‰è£…&lt;a href="http://www.scala-sbt.org/download.html"&gt;SBT&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;è¿è¡ŒSBTçš„å®‰è£…ç¨‹åºï¼Œè¿è¡Œå®Œæˆåï¼Œé‡æ–°æ‰“å¼€windowså‘½ä»¤è¡Œï¼Œè¾“å…¥&lt;code&gt;sbt&lt;/code&gt;ï¼Œæ£€æŸ¥æ˜¯å¦è¯†åˆ«æ­¤å‘½ä»¤ã€‚æ²¡æœ‰çš„è¯ï¼Œæ‰‹åŠ¨é…ç½®ç¯å¢ƒå˜é‡ï¼Œæ·»åŠ &lt;code&gt;...\sbt\bin&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;è¿è¡Œå®ŒSBTçš„å®‰è£…ç¨‹åºä¹‹åï¼Œå¹¶ä¸æ„å‘³ç€å®Œæˆäº†sbtçš„å®‰è£…ï¼Œåœ¨windowså‘½ä»¤æ”¾ä¸‹è¾“å…¥&lt;code&gt;sbt&lt;/code&gt;åï¼ŒSBTä¼šè‡ªåŠ¨çš„ä¸‹è½½å®‰è£…å®ƒæ‰€éœ€è¦çš„ç¨‹åºåŒ…ï¼Œè¯·è€å¿ƒç­‰å¾…å…¨éƒ¨ä¸‹è½½æˆåŠŸã€‚&lt;/p&gt;
&lt;h4&gt;å®‰è£…&lt;a href="http://git-scm.com/download/"&gt;Git&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;è¿è¡ŒGitçš„å®‰è£…ç¨‹åºï¼Œå®‰è£…å®Œæˆåï¼Œé‡æ–°æ‰“å¼€windowså‘½ä»¤è¡Œï¼Œæ£€æŸ¥æ—¶å€™è¯†åˆ«&lt;code&gt;git&lt;/code&gt;å‘½ä»¤ã€‚&lt;/p&gt;
&lt;h4&gt;å®‰è£…&lt;a href="http://www.jetbrains.com/idea/download/"&gt;IDEA&lt;/a&gt;&lt;/h4&gt;
&lt;h4&gt;å®‰è£…IDEAçš„Scalaæ’ä»¶&lt;/h4&gt;
&lt;p&gt;æ‰“å¼€IDEAï¼Œåœ¨â€˜Welcome to IntelliJ IDEAâ€™ç•Œé¢çš„â€˜Quick Startâ€™æ ï¼Œç‚¹å‡»&lt;code&gt;Configure&lt;/code&gt;ï¼Œé€‰æ‹©&lt;code&gt;Plugins&lt;/code&gt;ã€‚  &lt;/p&gt;
&lt;p&gt;åœ¨å¼¹å‡ºçš„çª—å£ä¸­å¯ä»¥çœ‹åˆ°å·²å®‰è£…çš„æ’ä»¶ï¼Œç°åœ¨IDEAé»˜è®¤è¿˜æ²¡æœ‰Scalaçš„æ’ä»¶ã€‚éœ€è¦ç‚¹å‡»å·¦ä¸‹è§’çš„&lt;code&gt;Install JetBrains plugin...&lt;/code&gt;ï¼Œåœ¨æœç´¢æ¡†ä¸­è¾“å…¥â€˜scalaâ€™ï¼Œç‚¹å‡»å®‰è£…ã€‚å®‰è£…å®Œæˆåå¯èƒ½ä¼šè¦æ±‚é‡å¯ä¸€ä¸‹IDEAã€‚&lt;/p&gt;
&lt;h4&gt;è§£å‹ç¼©Spark Source CodeåŒ…&lt;/h4&gt;
&lt;h2&gt;å¯¼å…¥Sparkå·¥ç¨‹&lt;/h2&gt;
&lt;p&gt;åœ¨æ¬¢è¿ç•Œé¢â€˜Quick Startâ€™æ æˆ–è€…æ˜¯åœ¨ä¸»ç•Œé¢çš„èœå•æ &lt;code&gt;File&lt;/code&gt;ä¸‹ï¼Œé€‰&lt;code&gt;Import Project&lt;/code&gt;ï¼Œæ‰¾åˆ°è§£å‹ä¹‹åçš„sparkå·¥ç¨‹æ–‡ä»¶å¤¹ï¼Œ&lt;code&gt;OK&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é€‰æ‹©&lt;code&gt;import project from external model&lt;/code&gt;ä¸­çš„&lt;code&gt;SBT project&lt;/code&gt;ï¼Œï¼ˆè¿™ä¸ªé€‰é¡¹åªæœ‰åœ¨å®‰è£…äº†IDEAçš„Scalaæ’ä»¶æ‰ä¼šæœ‰ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹ä¸€æ­¥ï¼Œé€‰æ‹©Project SDKä¸ºJDKï¼Œæœ€å¥½å‹¾ä¸Š&lt;code&gt;Use auto-import&lt;/code&gt;ï¼Œç„¶åç‚¹å‡»&lt;code&gt;Finish&lt;/code&gt;ã€‚è¿™æ—¶ï¼Œ&lt;strong&gt;IDEAä¼šè‡ªåŠ¨ä¸‹è½½å®‰è£…SBTæ‰€éœ€çš„å„ä¸ªåŒ…&lt;/strong&gt;ï¼Œæ²¡æœ‰è£…Gitçš„è¯å¯èƒ½ä¼šæŠ¥é”™ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸ºSparkæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤§çš„å·¥ç¨‹ï¼Œæ‰€éœ€çš„åŒ…ä¹Ÿå¾ˆå¤šï¼Œè¿™ä¸ªè¿‡ç¨‹ä¹Ÿä¼šç‰¹åˆ«æ…¢ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚&lt;/p&gt;
&lt;h4&gt;å¯¼å…¥å®Œæˆ&lt;/h4&gt;
&lt;p&gt;å¯¼å…¥å®Œæˆåï¼Œè‡ªåŠ¨æ‰“å¼€å·¥ç¨‹ï¼Œè¦ç­‰ä¸€æ®µæ—¶é—´ï¼Œç­‰å¾…sbtå¯¹è¿™ä¸ªå·¥ç¨‹è¿›è¡Œç¼–è¯‘ã€‚&lt;/p&gt;</summary><category term="spark"></category><category term="æºç "></category></entry><entry><title>Sparkç®€ä»‹</title><link href="http://www.guozhongxin.com/pages/2014/10/12/a_brief_in_spark.html" rel="alternate"></link><updated>2014-10-12T21:00:00+08:00</updated><author><name>guozhongxin</name></author><id>tag:www.guozhongxin.com,2014-10-12:pages/2014/10/12/a_brief_in_spark.html</id><summary type="html">&lt;h1&gt;ç›®å½•ï¼š&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Sparkç»¼è¿°&lt;/li&gt;
&lt;li&gt;Sparkè®¡ç®—æ¨¡å‹ï¼šRDDï¼Œç®—å­ï¼Œstageï¼Œ&lt;/li&gt;
&lt;li&gt;Sparkæ¶æ„åŠå·¥ä½œæµç¨‹&lt;/li&gt;
&lt;li&gt;Sparkç»„ä»¶&lt;/li&gt;
&lt;li&gt;Sparké…ç½®&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;Sparkç»¼è¿°--Sparkæ˜¯ä»€ä¹ˆ&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;åŸºäºå†…å­˜çš„åˆ†å¸ƒå¼å¹¶è¡Œè®¡ç®—æ¡†æ¶&lt;/li&gt;
&lt;li&gt;ä¸€ç§ç²—ç²’åº¦æ•°æ®å¹¶è¡Œï¼ˆdata parallelï¼‰çš„è®¡ç®—èŒƒå¼ï¼ˆç›¸å¯¹äº task parallelï¼‰&lt;/li&gt;
&lt;li&gt;ä»¥RDD(å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†)ä¸ºè®¡ç®—å¯¹è±¡&lt;/li&gt;
&lt;li&gt;æ ¸å¿ƒä»£ç ä¸¤ä¸‡è¡Œï¼Œè½»é‡çº§åˆ†å¸ƒå¼ç³»ç»Ÿ&lt;/li&gt;
&lt;li&gt;æ”¯æŒHadoop2.0ï¼Œæ”¯æŒHDFS&lt;/li&gt;
&lt;li&gt;æ”¯æŒå†…å­˜è®¡ç®—ã€å¤šè¿­ä»£æ‰¹é‡å¤„ç†ã€å³å¸­æŸ¥è¯¢ã€æµå¤„ç†å’Œå›¾è®¡ç®—  &lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;Sparkè®¡ç®—æ¨¡å‹&lt;/h1&gt;
&lt;h3&gt;å¼¹æ€§çš„åˆ†å¸ƒæ•°æ®é›†(RDD)&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;åˆ†å¸ƒå¼å¯¹è±¡é›†åˆèƒ½å¤Ÿè·¨é›†ç¾¤åœ¨å†…å­˜ä¸­ä¿å­˜ã€‚å¤šä¸ªå¹¶è¡Œæ“ä½œï¼Œå¤±è´¥è‡ªåŠ¨æ¢å¤ã€‚&lt;/li&gt;
&lt;li&gt;A list of partitions;&lt;/li&gt;
&lt;li&gt;AÂ functionÂ for computing each split&lt;/li&gt;
&lt;li&gt;A list ofÂ dependenciesÂ on other RDDs: HadoopRDDï¼ŒShuffledRDDï¼ŒPartitionPruningRDDâ€¦  &lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;ç®—å­&lt;/h3&gt;
&lt;p&gt;ç®—å­ï¼Œå³å¯¹æ•°æ®é›†RDDè¿›è¡Œæ“ä½œçš„å‡½æ•°ã€‚&lt;br /&gt;
Sparkè®¡ç®—æ¨¡å‹ä¸­ï¼Œæ€»å…±æ¶‰åŠå››ç§ç®—å­ã€‚    &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¾“å…¥ç®—å­ï¼šval lines = sc.textFile("data.txt")&lt;/li&gt;
&lt;li&gt;ç¼“å­˜ç®—å­ï¼šlines.cache(), lines.persist()&lt;/li&gt;
&lt;li&gt;å˜æ¢ç®—å­(Transformations)ï¼šÂ create a new dataset from an existing oneï¼Œç”±ä¸€ä¸ªï¼ˆæˆ–å¤šä¸ªï¼‰å·²å­˜åœ¨çš„RDDè½¬æ¢æˆå¦å¤–ä¸€ä¸ªRDDï¼šmap(), filter(), group(), flatmap()â€¦&lt;/li&gt;
&lt;li&gt;è¡ŒåŠ¨ç®—å­(Actions)ï¼šÂ return a value to the driver program after running a computation on the datasetï¼Œç”±RDDè½¬æ¢æˆï¼šreduce(), count()â€¦  &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸‹å›¾å¯ä»¥è¾ƒä¸ºæ¸…æ¥šçš„ç†è§£å››ç§ç®—å­ï¼š&lt;br /&gt;
&lt;img alt="1" src="http://www.guozhongxin.com/images/suanzi.png" /&gt;  &lt;/p&gt;
&lt;h4&gt;&amp;gt;&amp;gt;ç®—å­çš„æ‰§è¡Œ&lt;/h4&gt;
&lt;p&gt;ä»RDDåˆ°RDDçš„å˜æ¢ç®—å­åºåˆ—ï¼Œä¸€ç›´åœ¨RDDç©ºé—´å‘ç”Ÿã€‚è¿™é‡Œå¾ˆé‡è¦çš„è®¾è®¡æ˜¯&lt;code&gt;lazy evaluation&lt;/code&gt;ï¼šè®¡ç®—å¹¶ä¸å®é™…å‘ç”Ÿï¼Œåªæ˜¯ä¸æ–­åœ°è®°å½•åˆ°å…ƒæ•°æ®ã€‚å…ƒæ•°æ®çš„ç»“æ„æ˜¯&lt;code&gt;DAG&lt;/code&gt;ï¼ˆæœ‰å‘æ— ç¯å›¾ï¼‰ï¼Œå…¶ä¸­æ¯ä¸€ä¸ªâ€œé¡¶ç‚¹â€æ˜¯RDDï¼ˆåŒ…æ‹¬ç”Ÿäº§è¯¥RDD çš„ç®—å­ï¼‰ï¼Œä»çˆ¶RDDåˆ°å­RDDæœ‰â€œè¾¹â€ï¼Œè¡¨ç¤ºRDDé—´çš„ä¾èµ–æ€§ã€‚Sparkç»™å…ƒæ•°æ®DAGå–äº†ä¸ªå¾ˆé…·çš„åå­—ï¼Œ&lt;code&gt;Lineage&lt;/code&gt;ï¼ˆä¸–ç³»ï¼‰ã€‚  &lt;/p&gt;
&lt;p&gt;Lineageä¸€ç›´å¢é•¿ï¼Œç›´åˆ°é‡ä¸Šè¡ŒåŠ¨ï¼ˆactionï¼‰ç®—å­ï¼ˆå›¾1ä¸­çš„ç»¿è‰²ç®­å¤´ï¼‰ï¼Œè¿™æ—¶ å°±è¦evaluateäº†ï¼ŒæŠŠåˆšæ‰ç´¯ç§¯çš„æ‰€æœ‰ç®—å­ä¸€æ¬¡æ€§æ‰§è¡Œã€‚è¡ŒåŠ¨ç®—å­çš„è¾“å…¥æ˜¯RDDï¼ˆä»¥åŠè¯¥RDDåœ¨Lineageä¸Šä¾èµ–çš„æ‰€æœ‰RDDï¼‰ï¼Œè¾“å‡ºæ˜¯æ‰§è¡Œåç”Ÿ æˆçš„åŸç”Ÿæ•°æ®ï¼Œå¯èƒ½æ˜¯Scalaæ ‡é‡ã€é›†åˆç±»å‹çš„æ•°æ®æˆ–å­˜å‚¨ã€‚å½“ä¸€ä¸ªç®—å­çš„è¾“å‡ºæ˜¯ä¸Šè¿°ç±»å‹æ—¶ï¼Œè¯¥ç®—å­å¿…ç„¶æ˜¯è¡ŒåŠ¨ç®—å­ï¼Œå…¶æ•ˆæœåˆ™æ˜¯ä»RDDç©ºé—´è¿”å›åŸç”Ÿæ•°æ® ç©ºé—´ã€‚&lt;/p&gt;
&lt;p&gt;å¦ä¸€ä¸ªè¦ç‚¹æ˜¯ä¸€æ—¦è¡ŒåŠ¨ç®—å­äº§ç”ŸåŸç”Ÿæ•°æ®ï¼Œå°±å¿…é¡»é€€å‡ºRDDç©ºé—´ã€‚å› ä¸ºç›®å‰Sparkåªèƒ½å¤Ÿè·Ÿè¸ªRDDçš„è®¡ç®—ï¼ŒåŸç”Ÿæ•°æ®çš„è®¡ç®—å¯¹å®ƒæ¥è¯´æ˜¯ä¸å¯è§çš„ï¼ˆé™¤éä»¥å Sparkä¼šæä¾›åŸç”Ÿæ•°æ®ç±»å‹æ“ä½œçš„é‡è½½ã€wrapperæˆ–implicit conversionï¼‰ã€‚&lt;/p&gt;
&lt;h4&gt;&amp;gt;&amp;gt;shuffleï¼ˆé‡æ’ï¼‰&lt;/h4&gt;
&lt;p&gt;æ¶‰åŠé‡æ’ï¼Œç§°ä¸ºshuffleç±»æ“ä½œã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹å•ä¸ªRDDé‡æ’ï¼Œå¦‚sortã€partitionByï¼ˆå®ç°ä¸€è‡´æ€§çš„åˆ†åŒºåˆ’åˆ†ï¼Œè¿™ä¸ªå¯¹æ•°æ®æœ¬åœ°æ€§ä¼˜åŒ–å¾ˆé‡è¦ï¼Œåé¢ä¼šè®²ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;å¯¹å•ä¸ªRDDåŸºäºkeyè¿›è¡Œé‡ç»„å’Œreduceï¼Œå¦‚groupByKeyã€reduceByKeyï¼›&lt;/li&gt;
&lt;li&gt;å¯¹ä¸¤ä¸ªRDDåŸºäºkeyè¿›è¡Œjoinå’Œé‡ç»„ï¼Œå¦‚joinã€cogroupã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;å®½ä¾èµ–ä¸çª„ä¾èµ–&lt;/h3&gt;
&lt;p&gt;&lt;img alt="2" src="http://www.guozhongxin.com/images/dependency.png" /&gt;  &lt;/p&gt;
&lt;p&gt;å·¦ä¾§ä¸ºçª„ä¾èµ–ï¼Œå³ä¾§ä¸ºå®½ä¾èµ–  &lt;/p&gt;
&lt;p&gt;å®½ä¾èµ–ä¸çª„ä¾èµ–çš„æœ€ä¸»è¦åŒºåˆ«åœ¨äºï¼Œå®½ä¾èµ–å…³ç³»æ¶‰åŠåˆ°shuffleè¿‡ç¨‹ï¼Œè€Œçª„ä¾èµ–ä¸æ¶‰åŠshuffleã€‚  &lt;/p&gt;
&lt;h3&gt;Stage&lt;/h3&gt;
&lt;p&gt;Stageæ˜¯Sparkå¯¹DAGçš„åˆ’åˆ†ï¼Œä»¥æ­¤ä½œä¸ºå¯¹ä½œä¸šçš„è¿›è¡Œä»»åŠ¡ï¼ˆtaskï¼‰åˆ’åˆ†å’Œè°ƒåº¦çš„ä¾æ®ã€‚&lt;br /&gt;
å¯ä»¥è¿™æ ·ç†è§£Stageä¸éœ€è¦shuffleæ˜¯å¯ä»¥éšæ„å¹¶å‘çš„, æ‰€ä»¥stageçš„è¾¹ç•Œå°±æ˜¯éœ€è¦shuffleçš„åœ°æ–¹ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹å›¾æ˜¯ä¸€ä¸ªstageä¾‹å­ã€‚
&lt;img alt="3" src="http://www.guozhongxin.com/images/stage.png" /&gt; &lt;/p&gt;
&lt;h3&gt;å…±äº«å˜é‡ï¼ˆShared Variablesï¼‰&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å¹¿æ’­å˜é‡ï¼š&lt;br /&gt;
    å…è®¸ç¨‹åºå‘˜ä¿ç•™ä¸€ä¸ªåªè¯»çš„å˜é‡ï¼Œç¼“å­˜åœ¨æ¯ä¸€å°æœºå™¨ä¸Šï¼Œè€Œéæ¯ä¸ªä»»åŠ¡ã€‚è¢«åˆ›å»ºåï¼Œå®ƒèƒ½åœ¨é›†ç¾¤è¿è¡Œçš„ä»»ä½•å‡½æ•°ä¸Šï¼Œéœ€è¦è¢«å†æ¬¡ä¼ é€’åˆ°è¿™äº›ç»“ç‚¹ä¸Šã€‚
    é€šè¿‡SparkContext.broadcast(v)æ–¹æ³•åˆ›å»ºã€‚
    å¯¹è±¡vä¸èƒ½åœ¨è¢«å¹¿æ’­åä¿®æ”¹ï¼Œæ˜¯åªè¯»çš„ã€‚&lt;/li&gt;
&lt;li&gt;ç´¯åŠ å™¨ï¼š&lt;br /&gt;
    é€šè¿‡è°ƒç”¨SparkContext.accumulator(V)æ–¹æ³•æ¥åˆ›å»ºã€‚
    è¿è¡Œåœ¨é›†ç¾¤ä¸Šçš„ä»»åŠ¡ï¼Œå¯ä»¥ä½¿ç”¨+=æ¥åŠ å€¼ã€‚ç„¶è€Œï¼Œå®ƒä»¬ä¸èƒ½è¯»å–è®¡æ•°å™¨çš„å€¼ã€‚
    å½“Driverç¨‹åºå¯ä»¥ä½¿ç”¨.valueæ–¹æ³•è¯»å–è¯¥å€¼&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;Sparkæ¶æ„&lt;/h1&gt;
&lt;p&gt;å…ˆç»™ä¸€ä¸ªæ¦‚å†µå›¾ï¼š&lt;br /&gt;
&lt;img alt="4" src="http://www.guozhongxin.com/images/jiagou.png" /&gt; &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ„å»ºSpark Applicationè¿è¡Œç¯å¢ƒï¼›&lt;br /&gt;
    åœ¨Driver Programä¸­æ–°å»ºSparkContextï¼ˆåŒ…å«sparkcontextçš„ç¨‹åºç§°ä¸ºDriver Programï¼‰ï¼›
    Spark Applicationè¿è¡Œçš„è¡¨ç°æ–¹å¼ä¸ºï¼šåœ¨é›†ç¾¤ä¸Šè¿è¡Œç€ä¸€ç»„ç‹¬ç«‹çš„executorè¿›ç¨‹ï¼Œè¿™äº›è¿›ç¨‹ç”±sparkcontextæ¥åè°ƒï¼›&lt;/li&gt;
&lt;li&gt;SparkContextå‘èµ„æºç®¡ç†å™¨ç”³è¯·è¿è¡ŒExecutorèµ„æºï¼Œå¹¶å¯åŠ¨StandaloneExecutorBackendï¼Œexecutorå‘sparkcontentç”³è¯·taskï¼›
    é›†ç¾¤é€šè¿‡SparkContextè¿æ¥åˆ°ä¸åŒçš„cluster manager(standaloneã€yarnã€mesos)ï¼Œcluster managerä¸ºè¿è¡Œåº”ç”¨çš„Executoråˆ†é…èµ„æºï¼›ä¸€æ—¦è¿æ¥å»ºç«‹ä¹‹åï¼ŒSparkæ¯ä¸ªApplicationå°±ä¼šè·å¾—å„ä¸ªèŠ‚ç‚¹ä¸Šçš„Executorï¼ˆè¿›ç¨‹ï¼‰ï¼›æ¯ä¸ªApplicationéƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„executorè¿›ç¨‹ï¼›Executoræ‰æ˜¯çœŸæ­£è¿è¡Œåœ¨WorkNodeä¸Šçš„å·¥ä½œè¿›ç¨‹ï¼Œå®ƒä»¬ä¸ºåº”ç”¨æ¥è®¡ç®—æˆ–è€…å­˜å‚¨æ•°æ®ï¼›&lt;/li&gt;
&lt;li&gt;SparkContextè·å–åˆ°executorä¹‹åï¼ŒApplicationçš„åº”ç”¨ä»£ç å°†ä¼šè¢«å‘é€åˆ°å„ä¸ªexecutorï¼›&lt;/li&gt;
&lt;li&gt;SparkContextæ„å»ºRDD DAGå›¾ï¼Œå°†RDD DAGå›¾åˆ†è§£æˆStage DAGå›¾ï¼Œå°†Stageæäº¤ç»™TaskSchedulerï¼Œæœ€åç”±TaskSchedulerå°†Taskå‘é€ç»™Executorè¿è¡Œï¼›&lt;/li&gt;
&lt;li&gt;Taskåœ¨Executorä¸Šè¿è¡Œï¼Œè¿è¡Œå®Œæ¯•åé‡Šæ”¾æ‰€æœ‰èµ„æºï¼›&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Sparké€šç”¨çš„ä½¿ç”¨æ–¹å¼ä¸»è¦æœ‰ä¸¤ç§ï¼šstandaloneã€spark on yarn&lt;/p&gt;
&lt;h3&gt;standalone&lt;/h3&gt;
&lt;p&gt;åŸºäºstandaloneçš„Sparkæ¶æ„ä¸ä½œä¸šæ‰§è¡Œæµç¨‹ï¼ˆDriverè¿è¡Œåœ¨å®¢æˆ·ç«¯ä¸Šï¼‰ï¼š  &lt;/p&gt;
&lt;p&gt;&lt;img alt="5" src="http://www.guozhongxin.com/images/standalone.png" /&gt; &lt;/p&gt;
&lt;p&gt;ä½œä¸šæ‰§è¡Œæµç¨‹æè¿°ï¼š  &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å®¢æˆ·ç«¯å¯åŠ¨åç›´æ¥è¿è¡Œç”¨æˆ·ç¨‹åºï¼Œå¯åŠ¨Driverç›¸å…³çš„å·¥ä½œï¼šDAGSchedulerå’ŒBlockManagerMasterç­‰ã€‚&lt;/li&gt;
&lt;li&gt;å®¢æˆ·ç«¯çš„Driverå‘Masteræ³¨å†Œã€‚&lt;/li&gt;
&lt;li&gt;Masterè¿˜ä¼šè®©Workerå¯åŠ¨Exeuctorã€‚Workeråˆ›å»ºä¸€ä¸ªExecutorRunnerçº¿ç¨‹ï¼ŒExecutorRunnerä¼šå¯åŠ¨ExecutorBackendè¿›ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;ExecutorBackendå¯åŠ¨åä¼šå‘Driverçš„SchedulerBackendæ³¨å†Œã€‚Driverçš„DAGSchedulerè§£æä½œä¸šå¹¶ç”Ÿæˆç›¸åº”çš„Stageï¼Œæ¯ä¸ªStageåŒ…å«çš„Taské€šè¿‡TaskScheduleråˆ†é…ç»™Executoræ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;æ‰€æœ‰stageéƒ½å®Œæˆåä½œä¸šç»“æŸã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;Spark on Yarn&lt;/h3&gt;
&lt;p&gt;åŸºäºYarnçš„Sparkæ¶æ„ä¸ä½œä¸šæ‰§è¡Œæµç¨‹ï¼š&lt;br /&gt;
&lt;img alt="6" src="http://www.guozhongxin.com/images/taobao.png" /&gt; &lt;/p&gt;
&lt;p&gt;åŸºäºYARNçš„Sparkä½œä¸šé¦–å…ˆç”±å®¢æˆ·ç«¯ç”Ÿæˆä½œä¸šä¿¡æ¯ï¼Œæäº¤ç»™ResourceManagerï¼ŒResourceManageråœ¨æŸä¸€NodeManageræ±‡æŠ¥æ—¶æŠŠAppMasteråˆ†é…ç»™NodeManagerï¼ŒNodeManagerå¯åŠ¨ SparkAppMasterï¼ŒSparkAppMasterå¯åŠ¨ååˆå§‹åŒ–ä½œä¸šï¼Œç„¶åå‘ResourceManagerç”³è¯·èµ„æºï¼Œç”³è¯·åˆ°ç›¸åº”èµ„æºå SparkAppMasteré€šè¿‡RPCè®©NodeManagerå¯åŠ¨ç›¸åº”çš„SparkExecutorï¼ŒSparkExecutorå‘ SparkAppMasteræ±‡æŠ¥å¹¶å®Œæˆç›¸åº”çš„ä»»åŠ¡ã€‚æ­¤å¤–ï¼ŒSparkClientä¼šé€šè¿‡AppMasterè·å–ä½œä¸šè¿è¡ŒçŠ¶æ€ã€‚&lt;/p&gt;
&lt;p&gt;Spark on Yarnè¿™ç§æ¨¡å¼å› ä¸ºæ·˜å®æŠ€æœ¯éƒ¨åœ¨å†…éƒ¨å¹³å°ä¸Šçš„åº”ç”¨è€Œè¢«è®¸å¤šå…¶ä»–ä½¿ç”¨è€…æ¨¡ä»¿ï¼Œå…¶å®æ ¹æ®ç¬”è€…çš„æ„Ÿå—æ¥è®²ï¼Œç»å¤§å¤šæ•°ç±»å‹çš„ä»»åŠ¡sparkç€standaloneçš„æ¨¡å¼ä¸‹å°±èƒ½å¾ˆå¥½çš„è¿è¡Œï¼Œå¹¶æœ‰ä¸æ¬¡äºSpark on Yarnçš„æ‰§è¡Œæ•ˆç‡ã€‚   &lt;/p&gt;
&lt;h1&gt;Sparkç»„ä»¶&lt;/h1&gt;
&lt;h3&gt;DAGScheduler&lt;/h3&gt;
&lt;p&gt;DAGSchedulerä¸»è¦åŠŸèƒ½å¦‚ä¸‹ï¼š  &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¥æ”¶ç”¨æˆ·æäº¤çš„job;&lt;/li&gt;
&lt;li&gt;å°†jobæ ¹æ®ç±»å‹åˆ’åˆ†ä¸ºä¸åŒçš„stageï¼Œè®°å½•å“ªäº›RDDã€Stageè¢«ç‰©åŒ–ï¼Œå¹¶åœ¨æ¯ä¸€ä¸ªstageå†…äº§ç”Ÿä¸€ç³»åˆ—çš„taskï¼Œå¹¶å°è£…æˆTaskSetï¼›&lt;/li&gt;
&lt;li&gt;å†³å®šæ¯ä¸ªTaskçš„æœ€ä½³ä½ç½®(ä»»åŠ¡åœ¨æ•°æ®æ‰€åœ¨çš„èŠ‚ç‚¹ä¸Šè¿è¡Œ)ï¼Œå¹¶ç»“åˆå½“å‰çš„ç¼“å­˜æƒ…å†µï¼›å°†TaskSetæäº¤ç»™TaskScheduler;&lt;/li&gt;
&lt;li&gt;é‡æ–°æäº¤Shuffleè¾“å‡ºä¸¢å¤±çš„Stageç»™TaskSchedulerï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ³¨ï¼šä¸€ä¸ªStageå†…éƒ¨çš„é”™è¯¯ä¸æ˜¯ç”±shuffleè¾“å‡ºä¸¢å¤±é€ æˆçš„ï¼ŒDAGScheduleræ˜¯ä¸ç®¡çš„ï¼Œç”±TaskSchedulerè´Ÿè´£å°è¯•é‡æ–°æäº¤taskæ‰§è¡Œï¼›&lt;/p&gt;
&lt;h3&gt;TaskScheduler&lt;/h3&gt;
&lt;p&gt;TaskScheduleræ˜¯ä¸€ä¸ªå¯æ’æ‹”ä»»åŠ¡è°ƒåº¦æ¥å£ï¼Œä¸»è¦åŠŸèƒ½å¦‚ä¸‹ï¼š  &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€ä¸ªTaskScheduleråªä¸ºä¸€ä¸ªSparkContextæœåŠ¡ï¼Œæ¥æ”¶DAGScheduleræäº¤è¿‡æ¥çš„ä¸€ç»„ç»„çš„TaskSetï¼›&lt;/li&gt;
&lt;li&gt;TaskSchedulerå°†taskæäº¤åˆ°é›†ç¾¤ä¸­å¹¶æ‰§è¡Œï¼Œå¦‚æœå…¶ä¸­æŸä¸ªTaskæ‰§è¡Œå¤±è´¥åˆ™é‡è¯•ä¹‹ï¼›TaskSchedulerå°†TaskSetå¯¹åº”çš„æ‰§è¡Œç»“æœè¿”å›DAGSchedulerï¼›&lt;/li&gt;
&lt;li&gt;å¤„ç†straggleä»»åŠ¡ï¼›ï¼ˆæ¯”å¦‚ï¼š100ä¸ªä»»åŠ¡è¿è¡Œï¼Œå…¶ä¸­99ä¸ªä»»åŠ¡å¿«ï¼Œ1ä¸ªä»»åŠ¡æ…¢ï¼Œéœ€è¦åœ¨å¦å¤–ä¸€ä¸ªèŠ‚ç‚¹ä¸Šå¼€å¯ä¸€ä¸ªç›¸åŒçš„ä»»åŠ¡æ¥è¿è¡Œï¼Œè°å…ˆå®Œæˆå–ç”¨è°ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;é‡åˆ°shuffleè¾“å‡ºä¸¢å¤±åˆ™æ±‡æŠ¥ç»™DAGSchedulerï¼›&lt;/li&gt;
&lt;li&gt;ä¸ºæ¯ä¸ªTaskSetç»´æŠ¤ä¸€ä¸ªTaskSetManagerè¿½è¸ªæœ¬åœ°æ€§(resourceOffer--&amp;gt;findTask)åŠé”™è¯¯ä¿¡æ¯ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Storageæ¨¡å—&lt;/h3&gt;
&lt;p&gt;ä¸»è¦åˆ†ä¸ºä¸¤å±‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€šä¿¡å±‚ï¼šstorageæ¨¡å—é‡‡ç”¨çš„æ˜¯master-slaveç»“æ„æ¥å®ç°é€šä¿¡å±‚ï¼Œmasterå’Œslaveä¹‹é—´ä¼ è¾“æ§åˆ¶ä¿¡æ¯ã€çŠ¶æ€ä¿¡æ¯ï¼Œè¿™äº›éƒ½æ˜¯é€šè¿‡é€šä¿¡å±‚æ¥å®ç°çš„ã€‚&lt;/li&gt;
&lt;li&gt;å­˜å‚¨å±‚ï¼šstorageæ¨¡å—éœ€è¦æŠŠæ•°æ®å­˜å‚¨åˆ°diskæˆ–æ˜¯memoryä¸Šé¢ï¼Œæœ‰å¯èƒ½è¿˜éœ€replicateåˆ°è¿œç«¯ï¼Œè¿™éƒ½æ˜¯ç”±å­˜å‚¨å±‚æ¥å®ç°å’Œæä¾›ç›¸åº”æ¥å£ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å…¶ä»–æ¨¡å—è‹¥è¦å’Œstorageæ¨¡å—è¿›è¡Œäº¤äº’ï¼Œstorageæ¨¡å—æä¾›äº†ç»Ÿä¸€çš„æ“ä½œç±»BlockManagerï¼Œå¤–éƒ¨ç±»ä¸storageæ¨¡å—æ‰“äº¤é“éƒ½éœ€è¦é€šè¿‡è°ƒç”¨BlockManagerç›¸åº”æ¥å£æ¥å®ç°&lt;/p&gt;
&lt;h1&gt;Sparké…ç½®&lt;/h1&gt;
&lt;h3&gt;Sparké›†ç¾¤é…ç½®&lt;/h3&gt;
&lt;p&gt;é…ç½®æ–‡ä»¶ï¼š$SPARK_HOME/conf/spark-env.sh
ä¸»è¦çš„é…ç½®å‚æ•°æœ‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;SPARK_MASTER_IP, to bind the master to a different IP address or hostname&lt;/li&gt;
&lt;li&gt;SPARK_WORKER_CORES, to set the number of cores to use on this machine&lt;/li&gt;
&lt;li&gt;SPARK_WORKER_MEMORY, to set how much total memory workers have to give executors (e.g. 1000m, 2g)&lt;/li&gt;
&lt;li&gt;SPARK_WORKER_INSTANCES, to set the number of worker processes per node&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸¾ä¾‹ï¼šä¸€å…±5å°æœºå™¨ï¼Œæ¯å°24ä¸ªcpu coresï¼Œæ¯å°æœºå™¨ä¸Šæœ‰90GBå†…å­˜ï¼š
    export SPARK_WORKER_MEMORY=30000m
    export SPARK_WORKER_CORES=8
    export SPARK_WORKER_INSTANCES=3
å¦å¤–è¿˜æœ‰ä¸€äº›å…³äºHadoopçš„é…ç½®å‚æ•°ï¼Œè¿™æ˜¯ä¸ºäº†Spark on Yarnçš„å·¥ä½œæ¨¡å¼æä¾›çš„ï¼Œå¦‚æœä½ åªä½¿ç”¨Standaloneæ¨¡å¼ï¼Œåˆ™ä¸éœ€è¦é…ç½®ã€‚&lt;/p&gt;
&lt;h3&gt;&lt;a href="http://spark.apache.org/docs/latest/configuration.html"&gt;Saprkæ‰§è¡Œä½œä¸šå±æ€§&lt;/a&gt;&lt;/h3&gt;
&lt;h4&gt;&amp;gt;&amp;gt;é…ç½®æ–¹å¼&lt;/h4&gt;
&lt;p&gt;åœ¨Spark1.0.xæä¾›äº†3ç§æ–¹å¼çš„å±æ€§é…ç½®ï¼š  &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;SparkConfæ–¹å¼ï¼Œåœ¨ä»£ç ä¸­é…ç½®å„ä¸ªå‚æ•°ï¼›&lt;/li&gt;
&lt;li&gt;å‘½ä»¤è¡Œå‚æ•°æ–¹å¼
    ä½¿ç”¨spark-submitæˆ–spark-shellæäº¤åº”ç”¨ç¨‹åºæ—¶ç”¨å‘½ä»¤è¡Œå‚æ•°æäº¤ï¼›&lt;/li&gt;
&lt;li&gt;æ–‡ä»¶é…ç½®æ–¹å¼
    åœ¨$SPARK_HOME/conf/spark_default.confé‡Œè¿›è¡Œé…ç½®ï¼›è¯¥æ–¹å¼æ˜¯å°†å±æ€§é…ç½®é¡¹ä»¥é”®å€¼å¯¹æ–¹å¼å†™å…¥æ–‡æœ¬æ–‡ä»¶ä¸­ï¼Œä¸€ä¸ªé…ç½®é¡¹å ä¸€è¡Œï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¼˜å…ˆæƒï¼š&lt;br /&gt;
    SparkConfæ–¹å¼ &amp;gt; å‘½ä»¤è¡Œå‚æ•°æ–¹å¼ &amp;gt;æ–‡ä»¶é…ç½®æ–¹å¼&lt;/p&gt;
&lt;h4&gt;&amp;gt;&amp;gt;æŸ¥çœ‹Sparkå±æ€§é…ç½®&lt;/h4&gt;
&lt;p&gt;åœ¨åº”ç”¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œé€šè¿‡åº”ç”¨ç¨‹åºçš„webUIï¼ˆåœ°å€http://&lt;driver&gt;:4040ï¼‰å¯ä»¥æŸ¥çœ‹Sparkå±æ€§é…ç½®ï¼Œä»è€Œæ£€æŸ¥å±æ€§é…ç½®æ˜¯å¦æ­£ç¡®ï¼›&lt;br /&gt;
åªæ˜¯æ˜¾ç¤ºé€šè¿‡ä¸Šé¢ä¸‰ç§æ–¹å¼æ˜¾å¼æŒ‡å®šçš„å±æ€§é…ç½®ï¼Œå¯¹äºå…¶ä»–å±æ€§å¯ä»¥å‡å®šä½¿ç”¨é»˜è®¤é…ç½®ï¼›&lt;br /&gt;
å¯¹äºå¤§å¤šæ•°å†…éƒ¨æ§åˆ¶å±æ€§ï¼Œç³»ç»Ÿå·²ç»æä¾›äº†åˆç†çš„é»˜è®¤é…ç½®ã€‚  &lt;/p&gt;
&lt;h4&gt;&amp;gt;&amp;gt;Sparkæ—¥å¿—å±æ€§é…ç½®&lt;/h4&gt;
&lt;p&gt;Sparkæ—¥å¿—ï¼šlog4jï¼Œé…ç½®æ–‡ä»¶ï¼š$SPARK_HOME/conf/log4j.properties&lt;/p&gt;
&lt;p&gt;Spark job(Application)æ—¥å¿—ï¼Œè®¡æ•°å™¨ï¼šé€šè¿‡åˆšæ‰æåˆ°çš„ä¸‰ç§æ–¹å¼ä¸­çš„ä»»æ„ä¸€ç§ï¼Œå¯¹ä¸€ä¸‹Spark Confè¿›è¡Œé…ç½®ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;spark.eventLog.enabled=true;  
spark.eventLog.dir=hdfs:\\...
&lt;/pre&gt;&lt;/div&gt;</summary><category term="spark"></category><category term=""></category></entry><entry><title>Sparkå®‰è£…ï¼šSparké›†ç¾¤åŠå¼€å‘ç¯å¢ƒæ­å»º</title><link href="http://www.guozhongxin.com/pages/2014/09/26/spark_installation.html" rel="alternate"></link><updated>2014-09-26T23:00:00+08:00</updated><author><name>guozhongxin</name></author><id>tag:www.guozhongxin.com,2014-09-26:pages/2014/09/26/spark_installation.html</id><summary type="html">&lt;h2&gt;å®‰è£…Sparkå‡†å¤‡&lt;/h2&gt;
&lt;p&gt;åœ¨å‡†å¤‡å®‰è£…sparkä¹‹å‰ï¼Œéœ€è¦å‡†å¤‡ä»¥ä¸‹å®‰è£…åŒ…ï¼Œå¹¶å®Œæˆä»¥ä¸‹é¢„å¤‡åŠ¨ä½œã€‚  &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;scalaå®‰è£…åŒ…ï¼Œå¯ä»¥åœ¨&lt;a href="http://www.scala-lang.org/"&gt;scalaå®˜æ–¹ç½‘ç«™&lt;/a&gt;ä¸‹è½½&lt;/li&gt;
&lt;li&gt;sparkå®‰è£…åŒ…ï¼Œå¯ä»¥åœ¨&lt;a href="http://spark.apache.org/downloads.html"&gt;sparkå®˜ç½‘&lt;/a&gt;ä¸‹è½½ï¼Œç”¨ä¸¤ç§å½¢å¼çš„å®‰è£…åŒ…ï¼š&lt;ul&gt;
&lt;li&gt;source code package&lt;/li&gt;
&lt;li&gt;pre-build package&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;åœ¨ä¸»èŠ‚ç‚¹å®ç°sshå…å¯†ç ç™»é™†å…¶ä»–èŠ‚ç‚¹ã€‚  &lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;install scala - scalaå®‰è£…&lt;/h3&gt;
&lt;p&gt;download scala-2.10.4.tgz and unzipï¼š &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="x"&gt;tar -zxf scala-2.10.4.tgz&lt;/span&gt;
&lt;span class="x"&gt;vi ~/.bashrc&lt;/span&gt;
&lt;span class="x"&gt;    export SCALA_HOME=...   &lt;/span&gt;
&lt;span class="x"&gt;    export PATH=&lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;PATH&lt;/span&gt;&lt;span class="x"&gt;:&lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;SCALA_HOME&lt;/span&gt;&lt;span class="x"&gt;/bin&lt;/span&gt;
&lt;span class="x"&gt;source ~/.bashrc&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;install spark. - sparkå®‰è£…&lt;/h3&gt;
&lt;p&gt;There are two types of spark installation package, source package that you need build spark at first, and prebuild package.  &lt;/p&gt;
&lt;p&gt;Sparkçš„å®‰è£…åŒ…æœ‰ä¸¤ç§å½¢å¼ï¼šæºç åŒ…ï¼ˆç”¨æˆ·éœ€è¦è‡ªå·±ä¸‹è½½ååœ¨å¹³å°ä¸Šç¼–è¯‘ï¼‰ï¼Œä»¥åŠå·²ç»ç¼–è¯‘æ‰“åŒ…å¥½çš„å®‰è£…åŒ…&lt;/p&gt;
&lt;p&gt;To build source package, you should unzip the package and edit pom.xml in the directory, change &lt;hadoop.version&gt;&lt;/hadoop.version&gt; and some jars' version: protobuf, hbase, hive. Then, you can run this command :    &lt;/p&gt;
&lt;p&gt;åœ¨ç”¨æºç åŒ…å®‰è£…æ—¶ï¼Œä½ éœ€è¦å…ˆè§£å‹ç¼©å®‰è£…åŒ…ï¼Œç„¶åä¿®æ”¹æ–‡ä»¶å¤¹ä¸­ä¸­pom.xmlæ–‡ä»¶ï¼Œå°†hadoopã€protobufã€hbaseã€hiveçš„ç‰ˆæœ¬å·ä¿®æ”¹ä¸ºå½“å‰ç¯å¢ƒçš„ç‰ˆæœ¬ã€‚ä¹‹ååœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹è¿è¡Œè¿™æ¡å‘½ä»¤ï¼š  &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;./make-distribution.sh --hadoop 2.4.0 --with-yarn --with-hive --with-tachyon --tgz --skip-java-test
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;If you choose prebuild package with the right hadoop version, you needn't build it by yourself.   &lt;/p&gt;
&lt;p&gt;å¦‚æœä½ é€‰æ‹©äº†å·²ç»buildå¥½çš„å®‰è£…åŒ…ï¼Œä»¥ä¸Šæ­¥éª¤ä¸éœ€æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;å°†è‡ªå·±ç¼–è¯‘æˆ–æ˜¯ä¸‹è½½çš„ç¼–è¯‘åŒ…è§£å‹ç¼©ï¼Œå¹¶é…ç½®ç¯å¢ƒå˜é‡ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="x"&gt;tar -zxf spark-1.0.0-bin-2.2.0.tgz&lt;/span&gt;
&lt;span class="x"&gt;vi ~/.bashrc&lt;/span&gt;
&lt;span class="x"&gt;    export SCALA_HOME=...  &lt;/span&gt;
&lt;span class="x"&gt;    export PATH=&lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;PATH&lt;/span&gt;&lt;span class="x"&gt;:&lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;SCALA_HOME&lt;/span&gt;&lt;span class="x"&gt;/bin:&lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;SCALA_HOME&lt;/span&gt;&lt;span class="x"&gt;/sbin&lt;/span&gt;
&lt;span class="x"&gt;source ~/.bashrc&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Configure Spark cluster - Sparké›†ç¾¤é…ç½®&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;edit &lt;code&gt;$SPARK_HOME/conf/slaves&lt;/code&gt;, and input all node IP :  &lt;/p&gt;
&lt;p&gt;masters&lt;br /&gt;
slave1&lt;br /&gt;
slave2&lt;br /&gt;
slave3 &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;create and edit &lt;code&gt;$SPARK_HOME/conf/spark_env.sh&lt;/code&gt; &lt;/p&gt;
&lt;p&gt;export HADOOP_HOME=/opt/apache/hadoop-2.4.0&lt;br /&gt;
export HADOOP_CONF_DIR=/opt/apache/hadoop-2.4.0/etc/hadoop&lt;br /&gt;
export JAVA_HOME=/usr/local/jdk1.7.0_60&lt;br /&gt;
export SCALA_HOME=/home/yarn/scala-2.10.4  &lt;/p&gt;
&lt;p&gt;export SPARK_WORKER_MEMORY=16g&lt;br /&gt;
export SPARK_WORKER_INSTANCES=1&lt;br /&gt;
export SPARK_MASTER_IP=master&lt;/p&gt;
&lt;p&gt;å®é™…ä¸Šå®‰è£…å¥½ä¹‹å&lt;code&gt;conf&lt;/code&gt;æ–‡ä»¶å¤¹ä¸‹æœ‰ä¸€ä¸ª&lt;code&gt;spark_env.sh&lt;/code&gt;çš„æ¨¡æ¿ï¼Œé‡Œè¾¹æœ‰å„ä¸ªå˜é‡çš„è§£é‡Šè¯´æ˜ï¼Œåœ¨è¿™ä¸ä¸€ä¸€ç´¯è¿°  &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Copy to other node &lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¦å°†å„ä¸ªèŠ‚ç‚¹ä¸Šçš„è¿™ä¸¤ä¸ªæ–‡ä»¶éƒ½è¿›è¡Œé…ç½®&lt;/p&gt;
&lt;h3&gt;Configure Spark App - Sparkä½œä¸šå±æ€§é…ç½®&lt;/h3&gt;
&lt;p&gt;å¯¹äºä½œä¸šæ‰§è¡Œçš„å±æ€§é…ç½®ï¼Œsparkæä¾›äº†ä¸‰ç§ä¸åŒçš„é…ç½®æ–¹æ³•  &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;create and edit &lt;code&gt;$SPARK_HOME/conf/spark_default.conf&lt;/code&gt;  &lt;/p&gt;
&lt;p&gt;spark.master                    spark://master:7077&lt;br /&gt;
spark.eventLog.enabled          true&lt;br /&gt;
spark.eventLog.dir              hdfs://master:8020/sparklog&lt;br /&gt;
spark.local.dir                  ...  &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åœ¨é€šè¿‡$SPARK_HOME/bin/spark-submitè¿™ä¸ªè„šæœ¬æäº¤ä½œä¸šæ—¶ï¼Œé€šè¿‡ &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;SPARK_HOME&lt;/span&gt;&lt;span class="x"&gt;/bin/spark-submit  /&lt;/span&gt;
&lt;span class="x"&gt;--master spark://master:7077  /&lt;/span&gt;
&lt;span class="x"&gt;--conf spark.eventLog.enabled=true ...  /&lt;/span&gt;
&lt;span class="x"&gt;***.jar&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é€šè¿‡ä»£ç ä¸­å¯¹SparkContextæ¥å¯¹è¿™äº›å±æ€§èµ‹å€¼&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¿™ä¸‰ç§æ–¹æ³•çš„ä¼˜å…ˆçº§æ˜¯ï¼š&lt;br /&gt;
    3 é«˜äº 2 é«˜äº1  &lt;/p&gt;
&lt;h3&gt;Tips&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;If you change SPARK_WORKER_INSTANCES, CHECK worker's process in every node&lt;br /&gt;
If old worker's process is still working , you can use this command to kill them:  &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;ps -ef | grep Worker | grep -v grep | cut -c 9-15 | xargs kill -s 9
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;and restart Spark Cluster  &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;if you want to start history server, you should assign logs' path:  &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;SPARK_HOME&lt;/span&gt;&lt;span class="x"&gt;/sbin/start-historyserver.sh  &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;SPARK_HOME&lt;/span&gt;&lt;span class="x"&gt;/logs&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;If you wanna save a job's log, you should assign two properties:  &lt;/p&gt;
&lt;p&gt;spark.eventLog.enabled          true&lt;br /&gt;
spark.eventLog.dir              hdfs://master:8020/sparklog  &lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;</summary><category term="spark"></category><category term="å¼€å‘ç¯å¢ƒ"></category><category term=""></category></entry><entry><title>pelicanå»ºç«™æ”»ç•¥è¡¥å……ï¼ˆç«™å†…æœç´¢ï¼Œå’Œæ ‡ç­¾äº‘ï¼‰</title><link href="http://www.guozhongxin.com/pages/2014/09/25/build_blog_with_pelican.html" rel="alternate"></link><updated>2014-09-25T21:00:00+08:00</updated><author><name>guozhongxin</name></author><id>tag:www.guozhongxin.com,2014-09-25:pages/2014/09/25/build_blog_with_pelican.html</id><summary type="html">&lt;h2&gt;pelicanå»ºç«™å‡†å¤‡&lt;/h2&gt;
&lt;p&gt;å‚è§lizheruiçš„&lt;a href="http://www.lizherui.com/pages/2013/08/17/build_blog.html"&gt;ä¸€æ­¥ä¸€æ­¥æ‰“é€ Geeké£æ ¼çš„æŠ€æœ¯åšå®¢&lt;/a&gt;ï¼Œä¸ç´¯è¿°&lt;/p&gt;
&lt;hr /&gt;
&lt;h2&gt;æ·»åŠ ç«™å†…æœç´¢&lt;/h2&gt;
&lt;p&gt;ç”±äºåŸæ—¥å¿—ä¸­å…³äºæ·»åŠ googleç«™å†…æœç´¢çš„é“¾æ¥å¤±æ•ˆï¼Œåœ¨å…¶ä»–åœ°æ–¹æ²¡æœ‰çœ‹åˆ°ç‰¹åˆ«å¥½çš„ä»‹ç»ã€‚&lt;br /&gt;
æˆ‘é¦–å…ˆå°è¯•äº†ç›´æ¥åœ¨&lt;code&gt;pelicanconf.py&lt;/code&gt;ä¸­ç›´æ¥æ·»åŠ &lt;code&gt;GOOGLE_CUSTOM_SEARCH_NAVBAR&lt;/code&gt;è¿™ä¸€æ¡å±æ€§ï¼Œç»“æœåœ¨&lt;code&gt;make html&lt;/code&gt;ä¹‹åï¼Œå·¦ä¸Šè§’çš„searchæ¡†ï¼Œåœ¨å‚è€ƒäº†lizhuruiçš„åšå®¢ä»£ç åï¼Œæˆ‘æ˜¯è¿™æ ·å®ç°çš„ã€‚  &lt;/p&gt;
&lt;h3&gt;æ·»åŠ googleç«™å†…æœç´¢&lt;/h3&gt;
&lt;h4&gt;ä¿®æ”¹ä¸»é¢˜ï¼š&lt;/h4&gt;
&lt;p&gt;æ‰¾åˆ°è¿™ä¸ªä¸»é¢˜ï¼ˆ&lt;code&gt;tuxlite_tbs&lt;/code&gt;ï¼‰çš„templatesæ–‡ä»¶å¤¹ä¸­çš„&lt;code&gt;base.html&lt;/code&gt;ï¼Œåœ¨è¿™ä¸ªdiv(&lt;code&gt;&amp;lt;div class="nav-collapse"&amp;gt;&lt;/code&gt;)çš„æœ€åï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š  &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nt"&gt;&amp;lt;form&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;navbar-search pull-right&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;action=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/search.html&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;input&lt;/span&gt; &lt;span class="na"&gt;type=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;text&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;search-query&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;placeholder=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Search&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;q&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;s&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/form&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ›´æ–°pelicançš„ä¸»é¢˜ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;pelican-themes -U .../tuxlite_tbs
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;åˆ›å»ºsearch.html&lt;/h4&gt;
&lt;p&gt;ä¹‹åï¼Œåœ¨outputç›®å½•ä¸‹ï¼Œæ–°å»ºä¸€ä¸ªåä¸ºsearch.htmlçš„æ–‡ä»¶ï¼Œå†™å…¥ä¸‹é¢çš„å†…å®¹ï¼Œå…¶ä¸­éœ€è¦ä½ è‡ªå·±ä¿®æ”¹çš„æ˜¯googleç«™å†…æœç´¢çš„IDå·ï¼Œéœ€è¦è‡ªå·±åœ¨&lt;a href="https://www.google.com/cse/"&gt;googleç«™å†…æœç´¢&lt;/a&gt;çš„ç½‘ç«™ä¸Šè‡ªå·±ç”³è¯·ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;html&lt;/span&gt; &lt;span class="na"&gt;lang=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;zh_CN&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;meta&lt;/span&gt; &lt;span class="na"&gt;charset=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;utf-8&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;title&amp;gt;&lt;/span&gt;ç«™å†…æœç´¢&lt;span class="nt"&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;body&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;style&amp;gt;&lt;/span&gt;
&lt;span class="nf"&gt;#search-box&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;position&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;relative&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;width&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="m"&gt;50%&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;margin&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;padding&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="m"&gt;1em&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="nf"&gt;#search-form&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;height&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="m"&gt;30px&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;border&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="m"&gt;1px&lt;/span&gt; &lt;span class="k"&gt;solid&lt;/span&gt; &lt;span class="m"&gt;#999&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;webkit&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="k"&gt;border&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;radius&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="m"&gt;5px&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;moz&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="k"&gt;border&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;radius&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="m"&gt;5px&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;border&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;radius&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="m"&gt;5px&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;background-color&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="m"&gt;#fff&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;overflow&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;hidden&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="nf"&gt;#search-text&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;font-size&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="m"&gt;14px&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;color&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="m"&gt;#ddd&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;border-width&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;background&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;transparent&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="nf"&gt;#search-box&lt;/span&gt; &lt;span class="nt"&gt;input&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="nt"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;width&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="m"&gt;90%&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;padding&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="m"&gt;4px&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="m"&gt;12px&lt;/span&gt; &lt;span class="m"&gt;1em&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;color&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="m"&gt;#333&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;outline&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;none&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/style&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;div&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;search-box&amp;#39;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;form&lt;/span&gt; &lt;span class="na"&gt;action=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;/search.html&amp;#39;&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;search-form&amp;#39;&lt;/span&gt; &lt;span class="na"&gt;method=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;get&amp;#39;&lt;/span&gt; &lt;span class="na"&gt;target=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;_top&amp;#39;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;input&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;search-text&amp;#39;&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;q&amp;#39;&lt;/span&gt; &lt;span class="na"&gt;placeholder=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;Search&amp;#39;&lt;/span&gt; &lt;span class="na"&gt;type=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;text&amp;#39;&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;/form&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;div&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;cse&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;style=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;width: 100%;&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;Loading&lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;script &lt;/span&gt;&lt;span class="na"&gt;src=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;http://www.google.com/jsapi&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;type=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;text/javascript&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;script &lt;/span&gt;&lt;span class="na"&gt;type=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;text/javascript&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt; 
  &lt;span class="nx"&gt;google&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;load&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;search&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;language&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;zh-CN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;style&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;google&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;loader&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;V2_DEFAULT&lt;/span&gt;&lt;span class="p"&gt;});&lt;/span&gt;
  &lt;span class="nx"&gt;google&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;setOnLoadCallback&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;customSearchOptions&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{};&lt;/span&gt;  &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;customSearchControl&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nx"&gt;google&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;search&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;CustomSearchControl&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
      &lt;span class="s1"&gt;&amp;#39;012191777864628038963:**********&amp;lt;!å†™å…¥ä½ ç”³è¯·çš„googleç«™å†…æœç´¢çš„IDå·&amp;gt;ï¼‰&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;customSearchOptions&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="nx"&gt;customSearchControl&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;setResultSetSize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;google&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;search&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Search&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;FILTERED_CSE_RESULTSET&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;options&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nx"&gt;google&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;search&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;DrawOptions&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="nx"&gt;options&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;enableSearchResultsOnly&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt; 
    &lt;span class="nx"&gt;customSearchControl&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;draw&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cse&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;options&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;parseParamsFromUrl&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;params&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{};&lt;/span&gt;
      &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;parts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;window&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;location&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;search&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;substr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;\x26&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
      &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="nx"&gt;parts&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;keyValuePair&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;parts&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;=&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;key&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;decodeURIComponent&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;keyValuePair&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
        &lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;keyValuePair&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;?&lt;/span&gt;
            &lt;span class="nb"&gt;decodeURIComponent&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;keyValuePair&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sr"&gt;/\+/g&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="nx"&gt;keyValuePair&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;
      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;urlParams&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;parseParamsFromUrl&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;queryParamName&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;q&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;urlParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;queryParamName&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="nx"&gt;customSearchControl&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;urlParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;queryParamName&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;ç”Ÿæˆhtmlï¼Œå‘å¸ƒ&lt;/h4&gt;
&lt;p&gt;å°†è¿™ä¸ªhtmlæ–‡ä»¶ä¿å­˜åœ¨outputç›®å½•ï¼ˆç½‘ç«™çš„æ ¹ç›®å½•ï¼‰ä¸‹ï¼Œæ‰§è¡Œ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;make html
make github
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™æ ·ï¼Œæœç´¢æ¡†å°±å‡ºæ¥äº†ã€‚  &lt;/p&gt;
&lt;p&gt;&lt;img alt="1" src="http://www.guozhongxin.com/images/searchwithgoogle.png" /&gt;&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©googleç«™å†…æœç´¢åŠŸèƒ½æ›´å¥½çš„å·¥ä½œï¼Œä½ å¯åœ¨googleç«™é•¿å·¥å…·ä¸­æäº¤ä½ çš„sitemapï¼ˆè¿™ä¸ªå¯ä»¥åœ¨pelicanconf.pyä¸­é…ç½®sitemapæ’ä»¶ï¼Œç€æ‰§è¡Œmake htmlåèƒ½è‡ªåŠ¨ç”Ÿæˆï¼‰ã€‚&lt;/p&gt;
&lt;h4&gt;æäº¤sitemap&lt;/h4&gt;
&lt;p&gt;å¼•å…¥sitemapæ’ä»¶çš„å·¥ç¨‹è§lizheruiçš„æ—¥å¿—ã€‚è¿™æ ·åœ¨&lt;code&gt;make html&lt;/code&gt;ä¹‹åå°±èƒ½ç”Ÿæˆsitemap.xmlæ–‡ä»¶ï¼Œæäº¤åˆ°googleç«™é•¿ä¸Šï¼Œæœç´¢å°±å¯ä»¥ç”Ÿæ•ˆäº†ã€‚  &lt;/p&gt;
&lt;hr /&gt;
&lt;h3&gt;æ·»åŠ ç™¾åº¦ç«™å†…æœç´¢&lt;/h3&gt;
&lt;p&gt;è™½ç„¶å®ç°äº†googleç«™å†…æœç´¢çš„åŠŸèƒ½ï¼Œä½†æ˜¯ç”±äºGFWçš„åŸå› å¯¼è‡´å®é™…åœ¨ä½¿ç”¨googleç«™å†…æœç´¢æ—¶åŠ è½½å¤ªæ…¢ï¼Œæœ€ç»ˆï¼Œæˆ‘è¿˜æ˜¯æ— å¥ˆçš„é€‰æ‹©äº†ç™¾åº¦ç«™å†…æœç´¢ã€‚ã€‚ã€‚  &lt;/p&gt;
&lt;h4&gt;æ³¨å†Œ&lt;/h4&gt;
&lt;p&gt;åœ¨&lt;a href="http://zhanzhang.baidu.com/"&gt;ç™¾åº¦ç«™é•¿å¹³å°&lt;/a&gt;ä¸­æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œä¹‹åæ·»åŠ ç½‘ç«™ï¼ŒæŒ‰ç…§æç¤ºéªŒè¯ç½‘ç«™ã€‚&lt;br /&gt;
ä¹‹åå·¦ä¾§&lt;code&gt;å…¶ä»–å·¥å…·&lt;/code&gt;ä¸­æ‰¾åˆ°&lt;code&gt;ç«™å†…æœç´¢&lt;/code&gt;ï¼ŒæŒ‰ç…§æç¤ºå¡«å†™åŸºæœ¬ä¿¡æ¯ï¼Œé€‰æ‹©æœç´¢æ¡†æ ·å¼ï¼Œä¹‹åç‚¹å‡»&lt;code&gt;æŸ¥çœ‹ä»£ç &lt;/code&gt;ï¼Œå¤åˆ¶å…¶ä¸­å†…å®¹ï¼Œç•™ç”¨ã€‚  &lt;/p&gt;
&lt;h4&gt;ä¿®æ”¹ä¸»é¢˜&lt;/h4&gt;
&lt;p&gt;åŒæ ·åœ¨&lt;code&gt;base.html&lt;/code&gt;çš„è¿™ä¸ªä¸ªdiv(&lt;code&gt;&amp;lt;div class="nav-collapse"&amp;gt;&lt;/code&gt;)çš„æœ€åï¼Œæ–°å»ºä¸€ä¸ª&lt;code&gt;div&lt;/code&gt;ï¼Œåˆšæ‰æ³¨å†Œæœ€åå¤åˆ¶çš„ä»£ç ç²˜è´´åˆ°è¿™ä¸ª&lt;code&gt;div&lt;/code&gt;ä¸­ï¼š &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nt"&gt;&amp;lt;div&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;navbar-search pull-right&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;script&amp;gt;&lt;/span&gt;  
        &lt;span class="cp"&gt;&amp;lt;!ç•¥&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ›´æ–°pelicançš„ä¸»é¢˜ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;pelican-themes -U .../tuxlite_tbs
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;ç”Ÿæˆhtmlï¼Œå‘å¸ƒ&lt;/h4&gt;
&lt;p&gt;åŒä¸Š  &lt;/p&gt;
&lt;p&gt;&lt;img alt="2" src="http://www.guozhongxin.com/images/searchwithbaidu.png" /&gt;&lt;/p&gt;
&lt;h4&gt;æäº¤sitemap&lt;/h4&gt;
&lt;p&gt;åœ¨ç™¾åº¦ç«™é•¿å·¥å…·é‡Œæäº¤sitemapçš„è¿‡ç¨‹å’Œgoogleçš„ç±»ä¼¼ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ç™¾åº¦æœ‰è‡ªå·±çš„&lt;a href="http://zhanzhang.baidu.com/wiki/170#_2ä»€ä¹ˆæ˜¯sitemapç´¢å¼•æ–‡ä»¶ï¼Ÿ"&gt;sitemapæ ¼å¼&lt;/a&gt;ï¼Œç›´æ¥ç”¨lizheruiæ—¥å¿—ä¸­çš„æ–¹æ³•ç”Ÿæˆçš„sitemap.xmlä¸ç¬¦åˆç™¾åº¦çš„è¦æ±‚ï¼š  &lt;/p&gt;
&lt;p&gt;&lt;img alt="3" src="http://www.guozhongxin.com/images/sitemapofbaidu.png" /&gt;&lt;/p&gt;
&lt;p&gt;ç™¾åº¦sitemapè¦æ±‚æœ‰&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nt"&gt;&amp;lt;data&amp;gt;&amp;lt;display&amp;gt;&amp;lt;/display&amp;gt;&amp;lt;/data&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è€Œæˆ‘ä»¬ä½¿ç”¨çš„sitemapå·¥å…·é‡Œæ²¡æœ‰è¿™ä¸ªï¼Œéœ€è¦æ‰‹åŠ¨çš„å¯¹è¿™ä¸ªæ’ä»¶è¿›è¡Œä¿®æ”¹.&lt;/p&gt;
&lt;h4&gt;é…ç½®ç¬¦åˆç™¾åº¦ç«™å†…æœç´¢è§„åˆ™çš„pelican sitemapæ’ä»¶&lt;/h4&gt;
&lt;p&gt;æ‰¾åˆ°&lt;code&gt;.../pelican-plugins/sitemap/sitemap.py&lt;/code&gt;ï¼Œæ‰¾åˆ°å…¨å±€å˜é‡&lt;code&gt;XML_URL&lt;/code&gt;ï¼Œå°†å…¶ä¿®æ”¹ä¸ºä»¥ä¸‹å½¢å¼ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;XML_URL = &amp;quot;&amp;quot;&amp;quot;
&lt;span class="nt"&gt;&amp;lt;url&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;loc&amp;gt;&lt;/span&gt;{0}/{1}&lt;span class="nt"&gt;&amp;lt;/loc&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;lastmod&amp;gt;&lt;/span&gt;{2}&lt;span class="nt"&gt;&amp;lt;/lastmod&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;changefreq&amp;gt;&lt;/span&gt;{3}&lt;span class="nt"&gt;&amp;lt;/changefreq&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;priority&amp;gt;&lt;/span&gt;{4}&lt;span class="nt"&gt;&amp;lt;/priority&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;data&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;display&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/display&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/data&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/url&amp;gt;&lt;/span&gt;
&amp;quot;&amp;quot;&amp;quot;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™æ ·ï¼Œé‡æ–°&lt;code&gt;make html&lt;/code&gt;å°±èƒ½ç”Ÿæˆä¸€ä»½ç¬¦åˆç™¾åº¦ç«™å†…æœç´¢çš„sitemap.xmlã€‚å°†å…¶æäº¤åˆ°ç™¾åº¦ç«™å†…æœç´¢â€œæäº¤æ•°æ®â€ä¸­ï¼Œç­‰å¾…ç™¾åº¦éªŒè¯ä¹‹åï¼Œå°±èƒ½ä½“éªŒç™¾åº¦ç«™å†…æœç´¢åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™é‡Œåæ§½ä¸€å¥ï¼Œç™¾åº¦çš„ç«™é•¿å·¥å…·ç¡®å®ä¸å¦‚google webmastersï¼ŒåŒæ ·æ˜¯æäº¤sitemapï¼Œgoogleå¯ä»¥åšåˆ°ç«‹å³ç”Ÿæ•ˆï¼Œç™¾åº¦çš„è¦ç­‰è‡³å°‘ä¸€ä¸ªå°æ—¶ã€‚å¦‚æœæ²¡æœ‰GFWï¼Œæ‰æ‡’å¾—ç”¨ç™¾åº¦çš„å‘¢ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h2&gt;æ·»åŠ Tagsé“¾æ¥&lt;/h2&gt;
&lt;p&gt;åœ¨å…¶ä»–ä¸€äº›pelicanä¸»é¢˜ä¸­ï¼Œçœ‹åˆ°æœ‰æ ‡ç­¾äº‘ï¼Œæƒ³åˆ°Tagsçš„é“¾æ¥å¯èƒ½æ¯”Categoriesçš„é“¾æ¥æ›´æœ‰ç”¨ï¼Œé€šè¿‡æ›´æ”¹ä¸»é¢˜ï¼Œæ·»åŠ äº†ä¾§æ ä¸­çº¢æ¡†å†…çš„Tagsé“¾æ¥æ¡†ã€‚&lt;/p&gt;
&lt;h4&gt;ä¿®æ”¹ä¸»é¢˜&lt;/h4&gt;
&lt;p&gt;è¿˜æ˜¯æ‰¾åˆ°&lt;code&gt;base.html&lt;/code&gt;ï¼Œæ‰¾åˆ°categorieséƒ¨åˆ†ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nv"&gt;categories&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;div&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;well&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;style=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;padding: 8px 0; background-color: #FBFBFB;&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;ul&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;nav nav-list&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;li&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;nav-header&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt; 
    Categories
    &lt;span class="nt"&gt;&amp;lt;/li&amp;gt;&lt;/span&gt;

    &lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;cat&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;null&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="nv"&gt;categories&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;li&amp;gt;&amp;lt;a&lt;/span&gt; &lt;span class="na"&gt;href=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;SITEURL&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="s"&gt;/&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;cat.url&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;cat&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;&lt;/span&gt;
    &lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;endfor&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;                   
&lt;span class="nt"&gt;&amp;lt;/ul&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;endif&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;çœ‹åˆ°è¿™ä¸€éƒ¨åˆ†çš„ä»£ç ä¹‹åï¼Œå¾ˆå®¹æ˜“ä»¿å†™tagsé“¾æ¥æ¡†çš„éƒ¨åˆ†ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nv"&gt;tags&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;div&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;well&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;style=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;padding: 8px 0; background-color: #FBFBFB;&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;ul&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;nav nav-list&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;li&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;nav-header&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt; 
    Tags
    &lt;span class="nt"&gt;&amp;lt;/li&amp;gt;&lt;/span&gt;

&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;tag&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="nv"&gt;tags&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;li&amp;gt;&amp;lt;a&lt;/span&gt; &lt;span class="na"&gt;href=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;SITEURL&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="s"&gt;/&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;name.url&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;name&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;endfor&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/ul&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;endif&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å°†tagsä»£ç æ·»åŠ åˆ°categoriesæ¡†ä¹‹åã€‚æ‰§è¡Œ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;pelican-themes -U .../tuxlite_tbs
make html
make github
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™æ—¶ï¼Œä½ å°±èƒ½çœ‹åˆ°å·¦ä¾§æ å‡ºç°çš„TAGSé“¾æ¥æ¡†äº†ã€‚&lt;br /&gt;
&lt;img alt="4" src="http://www.guozhongxin.com/images/tags.png" /&gt;&lt;/p&gt;
&lt;p&gt;å®é™…ä¸Šè¿™ä¸æ˜¯ä¸€ä¸ªèƒ½ä½“ç°tagå‡ºç°é¢‘æ¬¡çš„tagäº‘ï¼Œå°å¼Ÿå®åœ¨æ²¡å­¦è¿‡å‰ç«¯æŠ€æœ¯ï¼Œå¤§ç¥çœ‹åˆ°æœ‰æ„Ÿå…´è¶£çš„å¯ä»¥æå‡ºè§£å†³çš„æ–¹æ³•ã€‚&lt;/p&gt;</summary><category term="pelican"></category><category term="python"></category><category term=""></category></entry></feed>